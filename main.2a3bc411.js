import{u as U,c as l,F as b,r as N,w as v,a as s,o as i,t as h,b as p,d as g,v as w,e as D,_ as O,f as W,g as c,A as z,h as L,i as k,j as X,k as T,l as q,m as K,n as _,p as Q,q as B,s as ce,x as M,y as Y,z as Z,B as G,C as I,D as oe,E as F,T as ie,G as he,H as fe,I as pe,J as ge,K as _e,L as ve,M as ye,N as we,O as be,P as ke,S as Pe,Q as Se,R as De,U as Ce}from"./shared.439c373c.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))u(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const m of a.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&u(m)}).observe(document,{childList:!0,subtree:!0});function d(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerpolicy&&(a.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?a.credentials="include":r.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function u(r){if(r.ep)return;r.ep=!0;const a=d(r);fetch(r.href,a)}})();const Ue=()=>{let e;const t=[],d={vendor:void 0,id:void 0,src:void 0,thumbnail:void 0,title:void 0,initialized:!1,y:void 0,debounce:250,lazyload:!0,autoplay:!0,initinview:!1,onLoad:f=>{},onAppend:f=>{},onThumbnailLoad:f=>{}},u={regex:{youtube_nocookie:/(?:youtube-nocookie\.com\/\S*(?:(?:\/e(?:mbed))?\/|watch\?(?:\S*?&?v\=)))([a-zA-Z0-9_-]{6,11})/,youtube:/(?:youtube\.com\/\S*(?:(?:\/e(?:mbed))?\/|watch\?(?:\S*?&?v\=))|youtu\.be\/)([a-zA-Z0-9_-]{6,11})/,vimeo:/vimeo\.com\/(?:video\/)?([0-9]*)(?:\?|)/},condition:{youtube:f=>f&&f[1].length==11?f[1]:!1,youtube_nocookie:f=>f&&f[1].length==11?f[1]:!1,vimeo:f=>f&&f[1].length===9||f[1].length===8?f[1]:!1},src:{youtube:f=>`https://www.youtube.com/embed/${f.id}/?autoplay=${f.autoplay?"1":"0"}&${f.query}`,youtube_nocookie:f=>`https://www.youtube-nocookie.com/embed/${f.id}/?autoplay=${f.autoplay?"1":"0"}&${f.query}`,vimeo:f=>`https://player.vimeo.com/video/${f.id}/?autoplay=${f.autoplay?"1":"0"}&${f.query}`},endpoint:f=>`https://noembed.com/embed?url=${f.src}`,response:{title:f=>f.title,thumbnail:f=>f.thumbnail_url}};function r(f,...y){if(e=Object.assign({},d,y[0]),typeof f=="string"){const S=document.querySelectorAll(f);for(let C=0;C<S.length;C++)a(S[C])}else if(typeof f.length>"u")a(f);else for(let S=0;S<f.length;S++)a(f[S]);e.lazyload&&A()}function a(f){if(!(f instanceof HTMLElement)||f.classList.contains("lazyframe--loaded"))return;const y={el:f,settings:m(f)};y.el.addEventListener("click",()=>{y.el.appendChild(y.iframe);const S=f.querySelectorAll("iframe");y.settings.onAppend.call(this,S[0])}),e.lazyload?R(y):V(y,!!y.settings.thumbnail)}function m(f){const y=Array.prototype.slice.apply(f.attributes).filter(C=>C.value!=="").reduce((C,E)=>{let H=E.name.indexOf("data-")===0?E.name.split("data-")[1]:E.name;return C[H]=E.value,C},{}),S=Object.assign({},e,y,{y:f.offsetTop,originalSrc:y.src,query:o(y.src)});if(S.vendor){const C=S.src.match(u.regex[S.vendor]);S.id=u.condition[S.vendor](C)}return S}function o(f){const y=f.split("?");return y[1]?y[1]:null}function n(f){return f.vendor?!f.title||!f.thumbnail:!1}function V(f){n(f.settings)?j(f,(y,S)=>{if(y)return;const C=S[0],E=S[1];if(E.settings.title||(E.settings.title=u.response.title(C)),!E.settings.thumbnail){const H=u.response.thumbnail(C);E.settings.thumbnail=H,f.settings.onThumbnailLoad.call(this,H)}R(E,!0)}):R(f,!0)}function j(f,y){const S=u.endpoint(f.settings),C=new XMLHttpRequest;C.open("GET",S,!0),C.onload=function(){if(C.status>=200&&C.status<400){const E=JSON.parse(C.responseText);y(null,[E,f])}else y(!0)},C.onerror=function(){y(!0)},C.send()}function A(){const f=window.innerHeight;let y=t.length;const S=($,ee)=>{$.settings.initialized=!0,$.el.classList.add("lazyframe--loaded"),y--,V($),$.settings.initinview&&$.el.click(),$.settings.onLoad.call(this,$)};t.filter($=>$.settings.y<f).forEach(S);const C=de(()=>{H=E<window.pageYOffset,E=window.pageYOffset,H&&t.filter($=>$.settings.y<f+E&&$.settings.initialized===!1).forEach(S),y===0&&window.removeEventListener("scroll",C,!1)},e.debounce);let E=0,H=!1;window.addEventListener("scroll",C,!1);function de($,ee,te){let J;return function(){let se=this,re=arguments,ue=function(){J=null,te||$.apply(se,re)},me=te&&!J;clearTimeout(J),J=setTimeout(ue,ee),me&&$.apply(se,re)}}}function R(f,y){if(f.iframe=x(f.settings),f.settings.thumbnail&&y&&(f.el.style.backgroundImage=`url(${f.settings.thumbnail})`),f.settings.title&&f.el.children.length===0){const S=document.createDocumentFragment(),C=document.createElement("span");C.className="lazyframe__title",C.innerHTML=f.settings.title,S.appendChild(C),f.el.appendChild(S)}e.lazyload||(f.el.classList.add("lazyframe--loaded"),f.settings.onLoad.call(this,f),t.push(f)),f.settings.initialized||t.push(f)}function x(f){const y=document.createDocumentFragment(),S=document.createElement("iframe");return f.vendor&&(f.src=u.src[f.vendor](f)),S.setAttribute("id",`lazyframe-${f.id}`),S.setAttribute("src",f.src),S.setAttribute("frameborder",0),S.setAttribute("allowfullscreen",""),f.autoplay&&(S.allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"),y.appendChild(S),y}return r},xe=Ue(),Re={class:"mb"},Le={class:"flex flex-gap"},Ve={class:"flex-center"},Ie={class:"flex flex-center"},Te=["onUpdate:modelValue"],Ee={class:"flex flex-center"},Oe=["onUpdate:modelValue"],$e=s("div",null,[s("button",{class:"btn btn-sm btn-primary"},"Update")],-1),Ae={__name:"AdminProductCodes",props:{platforms:{type:Array,required:!0},csrfToken:String,actionUrl:String,initialValues:{type:Object,required:!0}},setup(e){const t=e,{formData:d,result:u,onSubmit:r}=U(t);return(a,m)=>(i(),l("form",{onSubmit:m[0]||(m[0]=v(o=>D(r)(e.actionUrl,D(d)),["prevent"])),onChange:m[1]||(m[1]=(...o)=>a.onChange&&a.onChange(...o)),onInvalidCapture:m[2]||(m[2]=v((...o)=>a.onInvalid&&a.onInvalid(...o),["prevent"])),class:"border border-sm mb"},[(i(!0),l(b,null,N(e.platforms,o=>(i(),l("div",Re,[s("div",Le,[s("div",Ve,[s("b",null,h(o.name),1)]),s("div",Ie,[p(" ASIN "),g(s("input",{type:"text",class:"form-input ms-1",name:"asin","onUpdate:modelValue":n=>D(d)[o.id].asin=n},null,8,Te),[[w,D(d)[o.id].asin]])]),s("div",Ee,[p(" eBayID "),g(s("input",{type:"text",class:"form-input ms-1",name:"ebay_id","onUpdate:modelValue":n=>D(d)[o.id].ebay_id=n},null,8,Oe),[[w,D(d)[o.id].ebay_id]])])])]))),256)),$e],32))}},Ne={data(){return{companies:this.initialValues.companies,total:this.initialValues.total,page:this.initialValues.page,perPage:this.initialValues.perPage,maxPages:this.initialValues.maxPages,baseUrl:this.initialValues.baseUrl,loadingPage:!1,pagingParams:this.initialPagingParams}},props:["initialValues","showColumns","pagingMethod","initialPagingParams","pagingDisabled"],setup(e,t){return U({...e,initialValues:{companies:e.initialValues.companies,total:e.initialValues.total,page:e.initialValues.page,perPage:e.initialValues.perPage,baseUrl:e.initialValues.baseUrl,loadingPage:!1,pagingParams:e.initialPagingParams}},t)},mounted(){this.pagingDisabled||(window.addEventListener("popstate",this.onPopState),window.addEventListener("keyup",this.onHotkey))},beforeUnmount(){this.pagingDisabled||(window.removeEventListener("popstate",this.onPopState),window.removeEventListener("keyup",this.onHotkey))},computed:{numPages(){return W(parseInt(Math.ceil(this.total/this.perPage),10),0,this.maxPages)},showPaging(){return!!(this.numPages>0||this.pagingDisabled)}},methods:{onHotkey(e){switch(e.code){case"ArrowLeft":this.fetchPage(this.page-1,!0);break;case"ArrowRight":this.fetchPage(this.page+1,!0);break}},async fetchPage(e,t){if(e<1||e>=this.numPages+1||this.loadingPage)return;this.loadingPage=!0,await this.onSubmit(this.baseUrl,{...this.pagingParams,page:e})?(this.companies=this.result.data.companies,this.baseUrl=this.result.data.baseUrl,this.page=this.result.data.page,t&&(window.current_state_id=window.current_state_id||0,window.max_state_id=window.max_state_id||0,window.history.pushState(JSON.stringify({params:{...this.pagingParams,page:e,id:window.max_state_id+1}}),"",this.result.data.newUrl)),this.loadingPage=!1):(this.$emit("fetchPageFailed",this.result.error),this.loadingPage=!1)},onPopState(e){if(e.state===null)return;const t=JSON.parse(e.state);"params"in t&&(this.pagingParams=t.params),this.fetchPage(this.pagingParams.page),window.current_state_id=t.id}}},Be={class:"table table-browser companyBrowserList mb"},Me={width:"28"},qe=["href"],He=["src","width","height"],Ge={key:1,class:"img-thumbnail-sm flex-center"},je=s("span",{class:"icon icon-company"},null,-1),Fe=[je],Je=["href"],Ye={key:0,class:"no-select text-muted"},Ke={key:0,class:"text-disabled"},ze={key:2,class:"text-disabled"};function Ze(e,t,d,u,r,a){return i(),l("div",null,[s("table",Be,[s("tbody",null,[(i(!0),l(b,null,N(r.companies,m=>(i(),l("tr",{key:m.company_id},[s("td",Me,[s("a",{href:m.internal_url},[m.logo!==null?(i(),l("img",{key:0,src:m.logo.image_url,width:m.logo.width,height:m.logo.height,alt:"logo thumbnail",class:"img-thumbnail-logo img-thumbnail-sm"},null,8,He)):(i(),l("div",Ge,Fe))],8,qe)]),s("td",null,[s("a",{href:m.internal_url},h(m.name),9,Je)])]))),128))])]),a.showPaging?(i(),l("div",Ye,[p(" [ "),r.page<=1?(i(),l("span",Ke,"Prev")):(i(),l("a",{key:1,href:"#",onClick:t[0]||(t[0]=v(m=>a.fetchPage(r.page-1,!0),["prevent"])),rel:"nofollow"},"Prev")),p(" ] [ "),r.page===a.numPages?(i(),l("span",ze,"Next")):(i(),l("a",{key:3,href:"#",onClick:t[1]||(t[1]=v(m=>a.fetchPage(r.page+1,!0),["prevent"])),rel:"nofollow"},"Next")),p(" ] [ Page "+h(r.page)+" ] [ "+h(r.total.toLocaleString())+h(r.total===1e4?"+":"")+" results ] ",1)])):c("",!0)])}const ne=O(Ne,[["render",Ze]]),Qe={data(){return{fetching:!1,showComponent:"company-browser-list",showList:!0,companyList:this.initialValues}},components:{Alert:z,CompanyBrowserList:ne},props:["actionUrl","csrfToken","initialValues","allPlatforms","allTitles"],setup(e,t){return U({...e,initialValues:{page:e.initialValues.page,platform:e.initialValues.platform,title:e.initialValues.title,sort:"title"}},t)},methods:{onChange(){this.$nextTick(()=>{this.fetchCompanies(!0)})},async fetchCompanies(e){this.showList=!1,this.showComponent=null,this.fetching=!0,await this.onSubmit(this.actionUrl,Object.assign({},this.formData,{page:1}))?(e&&(window.current_state_id=window.current_state_id||0,window.max_state_id=window.max_state_id||0,window.history.pushState(JSON.stringify({params:{...this.formData,page:1,id:window.max_state_id+1}}),"",this.result.data.newUrl)),this.companyList=this.result.data,this.fetching=!1,this.showList=!0,this.showComponent="company-browser-list",this.fetching=!1):(this.companyList=[],this.fetching=!1)},onPopState(e){if(e.state===null)return;const t=JSON.parse(e.state);"params"in t&&(this.formData=t.params,this.fetchCompanies())}}},We={class:"grid-split-20-80 mb"},Xe={id:"form-company-browser"},et={class:"form-group"},tt={class:"form-group"},st=s("p",{class:"text-muted"},[s("b",null,"Hotkeys"),s("br"),s("small",null,[p(" Left Arrow (Prev)"),s("br"),p(" Right Arrow (Next) ")])],-1),rt={key:0,class:"alert alert-info"};function ot(e,t,d,u,r,a){const m=T("v-select");return i(),l("div",We,[s("div",null,[s("form",Xe,[s("div",et,[L(m,{"onUpdate:modelValue":[a.onChange,t[0]||(t[0]=o=>e.formData.platform=o)],name:"platform",modelValue:e.formData.platform,options:d.allPlatforms,reduce:o=>o.id,label:"name",placeholder:"All Platforms"},null,8,["onUpdate:modelValue","modelValue","options","reduce"])]),s("div",tt,[L(m,{"onUpdate:modelValue":[a.onChange,t[1]||(t[1]=o=>e.formData.title=o)],name:"title",modelValue:e.formData.title,options:d.allTitles,reduce:o=>o.id,label:"title",placeholder:"All Roles"},null,8,["onUpdate:modelValue","modelValue","options","reduce"])])]),st]),r.fetching?(i(),l("div",rt,"Fetching companies...")):c("",!0),r.showList?(i(),k(X(r.showComponent),{key:1,"initial-values":r.companyList,"paging-method":"POST","initial-paging-params":e.formData},null,8,["initial-values","initial-paging-params"])):c("",!0)])}const it=O(Qe,[["render",ot]]),nt={class:"dot-list mb-0"},at={key:0},lt={key:1},dt={key:2},ut={key:3},mt={key:1},ct=["href"],ht={__name:"CoverSwapLinks",props:{frontImage:Object,backImage:Object,numCovers:Number,moreUrl:String},setup(e){const t=e,d=q(!0),u=K(()=>t.backImage.url?t.numCovers-2:t.numCovers-1),r=()=>{d.value=!d.value,d.value?(document.querySelector("#cover").href=t.frontImage.url,document.querySelector("#cover > img").src=t.frontImage.image):(document.querySelector("#cover").href=t.backImage.url,document.querySelector("#cover > img").src=t.backImage.image)};return(a,m)=>(i(),l("ul",nt,[e.backImage.url?(i(),l(b,{key:0},[d.value?(i(),l("li",at," front ")):(i(),l("li",lt,[s("a",{href:"#",onClick:m[0]||(m[0]=v(o=>r(),["prevent"]))},"front")])),d.value?(i(),l("li",ut,[s("a",{href:"#",onClick:m[1]||(m[1]=v(o=>r(),["prevent"]))},"back")])):(i(),l("li",dt," back "))],64)):c("",!0),D(u)>0?(i(),l("li",mt,[s("a",{href:e.moreUrl},h(D(u))+" more",9,ct)])):c("",!0)]))}},ft={class:"overflow-x-scroll mb",style:{"max-height":"600px"}},pt={class:"table table-nowrap table-striped table-hover table-sticky mb"},gt={class:"text-right"},_t={class:"text-center"},vt={class:"text-center"},yt={class:"text-center"},wt={class:"text-center"},bt={class:"text-center"},kt={class:"text-center"},Pt={class:"text-right"},St={class:"text-center"},Dt={class:"text-center"},Ct={class:"text-center"},Ut={class:"text-center"},xt={class:"text-center"},Rt={class:"text-center"},Lt={__name:"DbStats",props:{stats:Array},setup(e){const t=e,d=q("name"),u=q(!1),r=m=>{u.value=!u.value,d.value=m},a=K(()=>t.stats.sort((m,o)=>{if(d.value==="name"){if(m.name.toUpperCase()<o.name.toUpperCase())return u.value?1:-1;if(m.name.toUpperCase()>o.name.toUpperCase())return u.value?-1:1}else{if((m[d.value]||0)<(o[d.value]||0))return u.value?1:-1;if((m[d.value]||0)>(o[d.value]||0))return u.value?-1:1}return 0}));return(m,o)=>(i(),l("div",ft,[s("table",pt,[s("thead",null,[s("tr",null,[s("th",gt,[s("a",{href:"#",onClick:o[0]||(o[0]=v(n=>r("name"),["prevent"]))},"Platform"),d.value==="name"?(i(),l("span",{key:0,class:_(["arrow ms-1",{"arrow-down":!u.value,"arrow-up":u.value}])},null,2)):c("",!0)]),s("th",_t,[s("a",{href:"#",onClick:o[1]||(o[1]=v(n=>r("games"),["prevent"]))},"Games"),d.value==="games"?(i(),l("span",{key:0,class:_(["arrow ms-1",{"arrow-down":u.value,"arrow-up":!u.value}])},null,2)):c("",!0)]),s("th",vt,[s("a",{href:"#",onClick:o[2]||(o[2]=v(n=>r("covers"),["prevent"]))},"Cover Art"),d.value==="covers"?(i(),l("span",{key:0,class:_(["arrow ms-1",{"arrow-down":u.value,"arrow-up":!u.value}])},null,2)):c("",!0)]),s("th",yt,[s("a",{href:"#",onClick:o[3]||(o[3]=v(n=>r("shots"),["prevent"]))},"Screenshots"),d.value==="shots"?(i(),l("span",{key:0,class:_(["arrow ms-1",{"arrow-down":u.value,"arrow-up":!u.value}])},null,2)):c("",!0)]),s("th",wt,[s("a",{href:"#",onClick:o[4]||(o[4]=v(n=>r("reviews"),["prevent"]))},"Player Reviews"),d.value==="reviews"?(i(),l("span",{key:0,class:_(["arrow ms-1",{"arrow-down":u.value,"arrow-up":!u.value}])},null,2)):c("",!0)]),s("th",bt,[s("a",{href:"#",onClick:o[5]||(o[5]=v(n=>r("critic_reviews"),["prevent"]))},"Critic Reviews"),d.value==="critic_reviews"?(i(),l("span",{key:0,class:_(["arrow ms-1",{"arrow-down":u.value,"arrow-up":!u.value}])},null,2)):c("",!0)]),s("th",kt,[s("a",{href:"#",onClick:o[6]||(o[6]=v(n=>r("prices"),["prevent"]))},"Prices"),d.value==="prices"?(i(),l("span",{key:0,class:_(["arrow ms-1",{"arrow-down":u.value,"arrow-up":!u.value}])},null,2)):c("",!0)])])]),s("tbody",null,[(i(!0),l(b,null,N(D(a),n=>(i(),l("tr",{key:n},[s("td",Pt,h(n.name),1),s("td",St,h(n.games.toLocaleString()),1),s("td",Dt,h(n.covers.toLocaleString()),1),s("td",Ct,h(n.shots.toLocaleString()),1),s("td",Ut,h(n.reviews.toLocaleString()),1),s("td",xt,h(n.critic_reviews.toLocaleString()),1),s("td",Rt,h(n.prices.toLocaleString()),1)]))),128))])])]))}},Vt={setup(e,t){return U({...e,initialValues:e.initialPagingParams},t)},data(){return{developers:this.initialValues.developers,total:this.initialValues.total,page:this.initialValues.page,maxPage:this.initialValues.maxPage,perPage:this.initialValues.perPage,baseUrl:this.initialValues.baseUrl,loadingPage:!1,pagingParams:this.initialPagingParams}},props:["initialValues","showColumns","pagingMethod","initialPagingParams","pagingDisabled"],mounted(){this.pagingDisabled||(window.addEventListener("popstate",this.onPopState),window.addEventListener("keyup",this.onHotkey))},beforeUnmount(){this.pagingDisabled||(window.removeEventListener("popstate",this.onPopState),window.removeEventListener("keyup",this.onHotkey))},computed:{numPages(){return W(parseInt(this.total/this.perPage,10),0,this.maxPage)},showPaging(){return!!(this.numPages>0||this.pagingDisabled)}},methods:{onHotkey(e){switch(e.code){case"ArrowLeft":this.fetchPage(this.page-1,!0);break;case"ArrowRight":this.fetchPage(this.page+1,!0);break}},async fetchPage(e,t){if(e<0||e>=this.numPages+1||this.loadingPage)return;await this.onSubmit(this.baseUrl,{...this.formData,page:e})?(this.developers=this.result.data.developers,this.baseUrl=this.result.data.baseUrl,this.page=this.result.data.page,t&&(window.current_state_id=window.current_state_id||0,window.max_state_id=window.max_state_id||0,window.history.pushState(JSON.stringify({params:{...this.pagingParams,page:e,id:window.max_state_id+1}}),"",this.result.data.newUrl)),this.loadingPage=!1):this.$emit("fetchPageFailed",this.result.errors)},onPopState(e){if(e.state===null)return;const t=JSON.parse(e.state);"params"in t&&(this.pagingParams=t.params),this.fetchPage(this.pagingParams.page),window.current_state_id=t.id}}},It={class:"table table-browser developerBrowserList mb"},Tt={width:"28"},Et=["href"],Ot=["src","width","height"],$t={key:1,class:"icon icon-user"},At=["href"],Nt={key:0,class:"no-select text-muted"},Bt={key:0,class:"text-disabled"},Mt={key:2,class:"text-disabled"};function qt(e,t,d,u,r,a){return i(),l("div",null,[s("table",It,[s("tbody",null,[(i(!0),l(b,null,N(r.developers,m=>(i(),l("tr",{key:m.developer_id},[s("td",Tt,[s("a",{href:m.internal_url},[m.shot!==null?(i(),l("img",{key:0,src:m.shot.tiny_url,width:m.shot.tiny_width,height:m.shot.tiny_height,alt:"portrait thumbnail",class:"img-thumbnail-photo img-thumbnail-sm"},null,8,Ot)):(i(),l("span",$t))],8,Et)]),s("td",null,[s("a",{href:m.internal_url},h(m.name),9,At)])]))),128))])]),a.showPaging?(i(),l("div",Nt,[p(" [ "),r.page<1?(i(),l("span",Bt,"Prev")):(i(),l("a",{key:1,href:"#",onClick:t[0]||(t[0]=v(m=>a.fetchPage(r.page-1,!0),["prevent"])),rel:"nofollow"},"Prev")),p(" ] [ "),r.page===a.numPages?(i(),l("span",Mt,"Next")):(i(),l("a",{key:3,href:"#",onClick:t[1]||(t[1]=v(m=>a.fetchPage(r.page+1,!0),["prevent"])),rel:"nofollow"},"Next")),p(" ] [ Page "+h(r.page+1)+" ] [ "+h(r.total.toLocaleString())+h(r.total===1e4?"+":"")+" results ] ",1)])):c("",!0)])}const ae=O(Vt,[["render",qt]]),Ht={data(){return{fetching:!1,showComponent:"developer-browser-list",showList:!0,developerList:this.initialValues}},setup(e,t){return U({...e,initialValues:{platform:null,title:null,sort:"title"}},t)},components:{Alert:z,DeveloperBrowserList:ae},props:["actionUrl","csrfToken","initialValues","allPlatforms","allTitles"],methods:{onChange(){this.$nextTick(()=>{this.fetchDevelopers(!0)})},async fetchDevelopers(e){this.showList=!1,this.showComponent=null,this.fetching=!0,await this.onSubmit(this.actionUrl,this.formData)?(e&&(window.current_state_id=window.current_state_id||0,window.max_state_id=window.max_state_id||0,window.history.pushState(JSON.stringify({params:{...this.formData,page:0,id:window.max_state_id+1}}),"",this.result.data.newUrl)),this.developerList=this.result.data,this.fetching=!1,this.showList=!0,this.showComponent="developer-browser-list",this.fetching=!1):(this.developerList=[],this.fetching=!1)},onPopState(e){if(e.state===null)return;const t=JSON.parse(e.state);"params"in t&&(this.formData=t.params,this.fetchDevelopers())}}},Gt={class:"grid-split-20-80 mb"},jt={id:"form-developer-browser"},Ft={class:"form-group"},Jt={class:"form-group"},Yt=s("p",{class:"text-muted"},[s("b",null,"Hotkeys"),s("br"),s("small",null,[p(" Left Arrow (Prev)"),s("br"),p(" Right Arrow (Next) ")])],-1),Kt={key:0,class:"alert alert-info"};function zt(e,t,d,u,r,a){const m=T("v-select");return i(),l("div",Gt,[s("div",null,[s("form",jt,[s("div",Ft,[L(m,{"onUpdate:modelValue":[a.onChange,t[0]||(t[0]=o=>e.formData.platform=o)],name:"platform",modelValue:e.formData.platform,options:d.allPlatforms,reduce:o=>o.id,label:"name",placeholder:"All Platforms"},null,8,["onUpdate:modelValue","modelValue","options","reduce"])]),s("div",Jt,[L(m,{"onUpdate:modelValue":[a.onChange,t[1]||(t[1]=o=>e.formData.title=o)],name:"title",modelValue:e.formData.title,options:d.allTitles,reduce:o=>o.id,label:"name",placeholder:"All Roles"},null,8,["onUpdate:modelValue","modelValue","options","reduce"])])]),Yt]),r.fetching?(i(),l("div",Kt,"Fetching developers...")):c("",!0),r.showList?(i(),k(X(r.showComponent),{key:1,"initial-values":r.developerList,"paging-method":"POST","initial-paging-params":e.formData},null,8,["initial-values","initial-paging-params"])):c("",!0)])}const Zt=O(Ht,[["render",zt]]),Qt={setup:U,data(){return{showDangerZone:!1,showChangePassword:!1,deleteConfirmed:!1,deleteText:"",newPassword:"",passChanged:!1,hasAvatarToUpload:!1}},props:["actionUrl","csrfToken","closeAccountUrl","initialValues","timeZones","regions","uploadAvatarUrl","changePasswordUrl"],watch:{deleteText(){this.deleteText==="delete"?this.deleteConfirmed=!0:this.deleteConfirmed=!1}},methods:{fileCheck(){this.$refs.avatarfile.files&&(this.hasAvatarToUpload=!0)},async uploadAvatar(){this.file=this.$refs.avatarfile.files[0];const e=new FormData;e.append("_csrf_token",this.csrfToken),e.append("file",this.file),e.append("user_id",this.formData.user_id);const{result:t,onSubmit:d}=U(this.$props);await d(this.uploadAvatarUrl,e,!1,!0)?this.formData.avatar=t.data.avatar:(this.modal=!0,this.modalBodyText=t.errors.SERVER_ERROR)},toggleClose(){this.showDangerZone=!this.showDangerZone},toggleChangePassword(){this.showChangePassword=!this.showChangePassword,this.passChanged=!1},async changePassword(){const{result:e,onSubmit:t}=U(this.$props),d={user_id:this.formData.user_id,new_password:this.newPassword};await t(this.changePasswordUrl,d)?(this.passChanged=e.data.password_changed,this.showChangePassword=!1,this.newPassword=""):console.error(e.errors)},closeAccount(){const{onSubmit:e}=U(this.$props);e(this.closeAccountUrl,{user_id:this.formData.user_id})}}},Wt={class:"form-group"},Xt=s("label",{class:"form-label",for:"display_name"},"Display Name",-1),es={class:"form-group"},ts=s("label",{class:"form-label",for:"user_name"},"Username",-1),ss={class:"form-group"},rs=s("label",{class:"form-label",for:"email"},"Email",-1),os={class:"form-group"},is=s("label",{class:"form-label",for:"avatar"},"Avatar",-1),ns={class:"flex flex-gap"},as=["src","width","height"],ls={class:"flex flex-gap"},ds={class:"form-group"},us=s("label",{class:"form-label",for:"url"},"Homepage",-1),ms={class:"form-group"},cs=s("label",{class:"form-label",for:"time_zone"},"Time zone",-1),hs=["value"],fs={class:"form-group"},ps=s("label",{class:"form-label",for:"city"},"City",-1),gs={class:"form-group"},_s=s("label",{class:"form-label",for:"country"},"Country",-1),vs=s("option",{value:"",selected:"",disabled:""},"Select Country",-1),ys=["label"],ws=["value"],bs={key:0,class:"form-group"},ks=s("label",{class:"form-label",for:"aim"},"AIM",-1),Ps={key:1,class:"form-group"},Ss=s("label",{class:"form-label",for:"msn"},"MSN",-1),Ds={key:2,class:"form-group"},Cs=s("label",{class:"form-label",for:"icq"},"ICQ",-1),Us={key:3,class:"form-group"},xs=s("label",{class:"form-label",for:"yahoo"},"Yahoo",-1),Rs={key:4,class:"form-group"},Ls=s("label",{class:"form-label",for:"gamertag"},"Xbox GamerTag",-1),Vs={class:"form-group"},Is=s("label",{class:"form-label",for:"steam"},"Steam Community ID",-1),Ts={class:"form-group"},Es=s("label",{class:"form-label",for:"discord"},"Discord",-1),Os={class:"form-group"},$s=s("label",{class:"form-label",for:"about_me"},"About Me",-1),As={class:"form-group"},Ns={class:"form-checkbox"},Bs=["checked"],Ms={class:"form-group"},qs={class:"form-checkbox"},Hs=["checked"],Gs={class:"flex"},js=["disabled"],Fs={key:5,class:"alert bg-highlight mt"},Js={class:"form-group"},Ys={key:6,class:"alert bg-highlight mt"},Ks=s("b",{class:"text-success"},"Your password was successfully updated!",-1),zs={key:7,class:"alert bg-highlight mt"},Zs=s("p",null,[s("b",{class:"text-danger"},"DELETING YOUR ACCOUNT IS NOT REVERSABLE!"),p(" Seriously. We won't be able to recover your account. ")],-1),Qs=s("p",null," Are you 100% sure you want to delete your account? ",-1),Ws=s("p",null,' Enter the word "delete" to confirm: ',-1),Xs={class:"form-group"},er=["disabled"];function tr(e,t,d,u,r,a){const m=T("form-alert"),o=T("error");return i(),l("form",{onSubmit:t[26]||(t[26]=v(n=>e.onSubmit(d.actionUrl,e.formData),["prevent"])),onChange:t[27]||(t[27]=(...n)=>e.onChange&&e.onChange(...n)),onInvalidCapture:t[28]||(t[28]=v((...n)=>e.onInvalid&&e.onInvalid(...n),["prevent"])),class:"mb"},[s("div",Wt,[Xt,g(s("input",{type:"type",class:_(["form-input",{"border-danger":e.result.errors.display_name}]),name:"display_name","onUpdate:modelValue":t[0]||(t[0]=n=>e.formData.display_name=n),placeholder:"Display Name",minlength:"3",maxlength:"50",required:""},null,2),[[w,e.formData.display_name]]),e.result.errors.display_name?(i(),k(m,{key:0,msg:e.result.errors.display_name},null,8,["msg"])):c("",!0)]),s("div",es,[ts,g(s("input",{type:"type",class:_(["form-input",{"border-danger":e.result.errors.user_name}]),name:"user_name","onUpdate:modelValue":t[1]||(t[1]=n=>e.formData.user_name=n),placeholder:"Username",minlength:"3",maxlength:"20",required:""},null,2),[[w,e.formData.user_name]]),e.result.errors.user_name?(i(),k(m,{key:0,msg:e.result.errors.user_name},null,8,["msg"])):c("",!0)]),s("div",ss,[rs,g(s("input",{type:"email",class:_(["form-input",{"border-danger":e.result.errors.email}]),name:"email",autocomplete:"username","onUpdate:modelValue":t[2]||(t[2]=n=>e.formData.email=n),placeholder:"Email",required:""},null,2),[[w,e.formData.email]]),e.result.errors.email?(i(),k(m,{key:0,msg:e.result.errors.email},null,8,["msg"])):c("",!0)]),s("div",os,[is,s("div",ns,[e.formData.avatar!==null?(i(),l("img",{key:0,src:e.formData.avatar.image_url,width:e.formData.avatar.width,height:e.formData.avatar.height,class:"avatar mb"},null,8,as)):c("",!0),s("div",ls,[s("input",{onChange:t[3]||(t[3]=(...n)=>a.fileCheck&&a.fileCheck(...n)),type:"file",name:"avatar",class:"form-input height-max-content",ref:"avatarfile"},null,544),r.hasAvatarToUpload?(i(),l("button",{key:0,type:"button",class:"btn btn-primary height-max-content",onClick:t[4]||(t[4]=(...n)=>a.uploadAvatar&&a.uploadAvatar(...n))},"Upload")):c("",!0)])])]),s("div",ds,[us,g(s("input",{type:"url",class:_(["form-input",{"border-danger":e.result.errors.url}]),name:"url","onUpdate:modelValue":t[5]||(t[5]=n=>e.formData.homepage=n),placeholder:"URL"},null,2),[[w,e.formData.homepage]]),e.result.errors.url?(i(),k(m,{key:0,msg:e.result.errors.url},null,8,["msg"])):c("",!0)]),s("div",ms,[cs,g(s("select",{name:"level",class:"form-control form-select","onUpdate:modelValue":t[6]||(t[6]=n=>e.formData.time_zone=n)},[(i(!0),l(b,null,N(d.timeZones,n=>(i(),l("option",{value:n.zone,key:n.zone},h(n.zone)+" ("+h(n.offset)+")",9,hs))),128))],512),[[Q,e.formData.time_zone]])]),s("div",fs,[ps,g(s("input",{type:"type",class:_(["form-input",{"border-danger":e.result.errors.city}]),name:"city","onUpdate:modelValue":t[7]||(t[7]=n=>e.formData.city=n),placeholder:"City",maxlength:"64"},null,2),[[w,e.formData.city]]),e.result.errors.city?(i(),k(m,{key:0,msg:e.result.errors.city},null,8,["msg"])):c("",!0)]),s("div",gs,[_s,g(s("select",{name:"level",class:"form-control form-select","onUpdate:modelValue":t[8]||(t[8]=n=>e.formData.country=n)},[vs,(i(!0),l(b,null,N(d.regions,n=>(i(),l("optgroup",{label:n.region,key:n.region},[(i(!0),l(b,null,N(n.countries,V=>(i(),l("option",{value:V.country_code,key:V.country_code},h(V.name),9,ws))),128))],8,ys))),128))],512),[[Q,e.formData.country]])]),e.formData.im_accounts.aim?(i(),l("div",bs,[ks,g(s("input",{name:"aim",type:"type",class:_(["form-input",{"border-danger":e.result.errors.aim}]),"onUpdate:modelValue":t[9]||(t[9]=n=>e.formData.im_accounts.aim=n),maxlength:"255"},null,2),[[w,e.formData.im_accounts.aim]]),e.result.errors.aim?(i(),k(m,{key:0,msg:e.result.errors.aim},null,8,["msg"])):c("",!0)])):c("",!0),e.formData.im_accounts.msn?(i(),l("div",Ps,[Ss,g(s("input",{name:"msn",type:"type",class:_(["form-input",{"border-danger":e.result.errors.msn}]),"onUpdate:modelValue":t[10]||(t[10]=n=>e.formData.im_accounts.msn=n),maxlength:"255"},null,2),[[w,e.formData.im_accounts.msn]]),e.result.errors.msn?(i(),k(m,{key:0,msg:e.result.errors.msn},null,8,["msg"])):c("",!0)])):c("",!0),e.formData.im_accounts.icq?(i(),l("div",Ds,[Cs,g(s("input",{name:"icq",type:"type",class:_(["form-input",{"border-danger":e.result.errors.icq}]),"onUpdate:modelValue":t[11]||(t[11]=n=>e.formData.im_accounts.icq=n),maxlength:"255"},null,2),[[w,e.formData.im_accounts.icq]]),e.result.errors.icq?(i(),k(m,{key:0,msg:e.result.errors.icq},null,8,["msg"])):c("",!0)])):c("",!0),e.formData.im_accounts.yahoo?(i(),l("div",Us,[xs,g(s("input",{name:"yahoo",type:"type",class:_(["form-input",{"border-danger":e.result.errors.yahoo}]),"onUpdate:modelValue":t[12]||(t[12]=n=>e.formData.im_accounts.yahoo=n),maxlength:"255"},null,2),[[w,e.formData.im_accounts.yahoo]]),e.result.errors.yahoo?(i(),k(m,{key:0,msg:e.result.errors.yahoo},null,8,["msg"])):c("",!0)])):c("",!0),e.formData.im_accounts.gamertag?(i(),l("div",Rs,[Ls,g(s("input",{name:"gamertag",type:"type",class:_(["form-input",{"border-danger":e.result.errors.gamertag}]),"onUpdate:modelValue":t[13]||(t[13]=n=>e.formData.im_accounts.gamertag=n),maxlength:"255"},null,2),[[w,e.formData.im_accounts.gamertag]]),e.result.errors.gamertag?(i(),k(m,{key:0,msg:e.result.errors.gamertag},null,8,["msg"])):c("",!0)])):c("",!0),s("div",Vs,[Is,g(s("input",{name:"steam",type:"type",class:_(["form-input",{"border-danger":e.result.errors.steam}]),"onUpdate:modelValue":t[14]||(t[14]=n=>e.formData.im_accounts.steam=n),maxlength:"255"},null,2),[[w,e.formData.im_accounts.steam]]),e.result.errors.steam?(i(),k(m,{key:0,msg:e.result.errors.steam},null,8,["msg"])):c("",!0)]),s("div",Ts,[Es,g(s("input",{name:"discord",type:"type",class:_(["form-input",{"border-danger":e.result.errors.discord}]),"onUpdate:modelValue":t[15]||(t[15]=n=>e.formData.im_accounts.discord=n),maxlength:"255"},null,2),[[w,e.formData.im_accounts.discord]]),e.result.errors.discord?(i(),k(m,{key:0,msg:e.result.errors.discord},null,8,["msg"])):c("",!0)]),s("div",Os,[$s,g(s("textarea",{class:_(["form-input",{"border-danger":e.result.errors.about_me}]),rows:"5",name:"about_me","onUpdate:modelValue":t[16]||(t[16]=n=>e.formData.about_me=n),placeholder:"What would you like to say about yourself?",maxlength:"10000"},`
      `,2),[[w,e.formData.about_me]]),e.result.errors.about_me?(i(),k(m,{key:0,msg:e.result.errors.about_me},null,8,["msg"])):c("",!0)]),s("div",As,[s("label",Ns,[g(s("input",{name:"moby_mail_list",class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[17]||(t[17]=n=>e.formData.moby_mail_list=n),checked:e.formData.moby_mail_list},null,8,Bs),[[B,e.formData.moby_mail_list]]),p(" Subscribe to the MobyGames mailing list ")]),e.result.errors.moby_mail_list?(i(),k(m,{key:0,msg:e.result.errors.moby_mail_list},null,8,["msg"])):c("",!0)]),s("div",Ms,[s("label",qs,[g(s("input",{name:"receive_approval_notifications",class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[18]||(t[18]=n=>e.formData.receive_approval_notifications=n),checked:e.formData.receive_approval_notifications},null,8,Hs),[[B,e.formData.receive_approval_notifications]]),p(" Receive approval notifications by email ")]),e.result.errors.receive_approval_notifications?(i(),k(m,{key:0,msg:e.result.errors.receive_approval_notifications},null,8,["msg"])):c("",!0)]),L(o,{error:e.result.errors.SERVER_ERROR},null,8,["error"]),s("div",Gs,[s("button",{type:"submit",class:"btn btn-primary me-sm",disabled:e.result.loading},"Update",8,js),s("button",{type:"button",class:"btn me-sm",onClick:t[19]||(t[19]=(...n)=>a.toggleChangePassword&&a.toggleChangePassword(...n))},"Change Password"),s("button",{type:"button",class:"btn",onClick:t[20]||(t[20]=(...n)=>a.toggleClose&&a.toggleClose(...n))},"Delete Account")]),r.showChangePassword?(i(),l("div",Fs,[s("div",Js,[g(s("input",{type:"password",class:_(["form-input",{"border-danger":e.result.errors.new_password}]),name:"new_password",autocomplete:"new-password","onUpdate:modelValue":t[21]||(t[21]=n=>r.newPassword=n),placeholder:"Password (at least 6 characters)",minlength:"6",maxlength:"255",required:""},null,2),[[w,r.newPassword]]),e.result.errors.new_password?(i(),k(m,{key:0,msg:e.result.errors.new_password},null,8,["msg"])):c("",!0)]),s("button",{type:"button",class:"btn btn-danger",onClick:t[22]||(t[22]=(...n)=>a.changePassword&&a.changePassword(...n))},"Submit")])):c("",!0),r.passChanged?(i(),l("div",Ys,[Ks,p(" All other logged-in devices have been logged out. ")])):c("",!0),r.showDangerZone?(i(),l("div",zs,[Zs,Qs,s("div",null,[Ws,s("div",Xs,[g(s("input",{type:"text","onUpdate:modelValue":t[23]||(t[23]=n=>r.deleteText=n),class:"form-input"},null,512),[[w,r.deleteText]])]),s("button",{type:"button",class:"btn btn me-sm",onClick:t[24]||(t[24]=(...n)=>a.toggleClose&&a.toggleClose(...n))},"No, just kidding!"),s("button",{type:"button",class:"btn btn-danger",disabled:!r.deleteConfirmed,onClick:t[25]||(t[25]=(...n)=>a.closeAccount&&a.closeAccount(...n))},"Permanently Delete Account",8,er)])])):c("",!0)],32)}const sr=O(Qt,[["render",tr]]),le={methods:{getHashValue(e){const t=decodeURIComponent(window.location.hash.substr(1));if(t.length>0){const d=JSON.parse(t);return e in d?d[e]:null}return null},setHashValue(e,t,d){if(this.getHashValue(e)===t)return;const u=decodeURIComponent(window.location.hash.substr(1));let r;u.length>0?r=JSON.parse(u):r={},t===null?delete r[e]:r[e]=t;const a=encodeURIComponent(JSON.stringify(r));d&&(window.current_state_id=window.current_state_id||0,window.max_state_id=window.max_state_id||0,window.history.state!==null&&window.history.replaceState({hash:window.history.state.hash,changed:window.history.state.changed,nextChanged:[e],id:window.history.state.id},"","#".concat(encodeURIComponent(u))),window.history.pushState(JSON.stringify({hash:r,changed:[e],nextChanged:[],id:window.max_state_id+1}),"","#".concat(a)),window.max_state_id+=1,window.current_state_id=window.max_state_id)},setHash(e){const t=encodeURIComponent(JSON.stringify(e));window.current_state_id=window.current_state_id||0,window.max_state_id=window.max_state_id||0,window.history.pushState(JSON.stringify({hash:e,id:window.max_state_id+1}),"","#".concat(t)),window.max_state_id+=1,window.current_state_id=window.max_state_id}}},rr={mixins:[le],props:["initialValues","showColumns","pagingMethod","initialPagingParams","pagingDisabled","showIcons","showPlatforms"],data(){return{games:this.initialValues.games,total:this.initialValues.total,page:this.initialValues.page,perPage:this.initialValues.perPage,maxPages:this.initialValues.maxPages,baseUrl:this.initialValues.baseUrl,loadingPage:!1,pagingParams:this.initialPagingParams,selectedPlatforms:this.initialPagingParams.platform,totalPages:Math.ceil(this.initialValues.total/this.initialValues.perPage)}},setup(e,t){return U({...e,initialValues:{games:e.initialValues.games,total:e.initialValues.total,page:e.initialValues.page,perPage:e.initialValues.perPage,baseUrl:e.initialValues.baseUrl,loadingPage:!1,pagingParams:e.initialPagingParams,selectedPlatforms:e.initialPagingParams.platform}},t)},mounted(){this.pagingDisabled||(window.addEventListener("popstate",this.onPopState),window.addEventListener("keyup",this.onHotkey))},beforeUnmount(){this.pagingDisabled||(window.removeEventListener("popstate",this.onPopState),window.removeEventListener("keyup",this.onHotkey))},computed:{totalPagesLabel(){return`of ${this.totalPages}`},numPages(){return W(this.totalPages,0,this.maxPages)},showPaging(){return!!(this.numPages>1||this.pagingDisabled)}},methods:{truncateTitle(e){return ce(e,50)},mobyScoreStyle(e){return`background: ${{0:"#888",1:"#ff0000",2:"#ff0000",3:"#ff0000",4:"#ff0000",5:"#ff8000",6:"#ffff00",7:"#00ff00",8:"#31ffec",9:"#00bcff",10:"#ff00ff"}[Math.floor(e)]}`},onHotkey(e){switch(e.code){case"ArrowLeft":this.fetchPage(this.page-1,!0);break;case"ArrowRight":this.fetchPage(this.page+1,!0);break}},getReleaseDates(e){const t=new Set;for(const[d]of Object.entries(this.selectedPlatforms)){const u=this.selectedPlatforms[d],r=e.find(a=>a.id===u);r&&t.add(r.release_date)}return[...t].sort().join(", ")},getDeveloperName(e){const t=e.find(({title_id:d})=>d===2);return t?`${t.name}`:null},getPlatformNames(e){return e.sort((t,d)=>t.name<d.name?-1:t.name>d.name?1:0),e.length>6?`${e[0].name}, ${e[1].name}, ${e[2].name}, ${e[3].name}, ${e[4].name}, ${e[5].name}...`:e.map(t=>t.name).join(", ")},async fetchPage(e,t){if(e<1||e>=this.numPages+1||this.loadingPage)return;this.loadingPage=!0,await this.onSubmit(this.baseUrl,{...this.pagingParams,page:e})?(this.games=this.result.data.games,this.baseUrl=this.result.data.baseUrl,this.page=this.result.data.page,this.total=this.result.data.total,t&&(window.current_state_id=window.current_state_id||0,window.max_state_id=window.max_state_id||0,window.history.pushState(JSON.stringify({params:{...this.pagingParams,page:e,id:window.max_state_id+1}}),"",this.result.data.newUrl)),this.loadingPage=!1):(this.$emit("fetchPageFailed",this.result.error),this.loadingPage=!1)},onPopState(e){if(e.state===null)return;const t=JSON.parse(e.state);"params"in t&&(this.pagingParams=t.params),this.fetchPage(this.pagingParams.page),window.current_state_id=t.id}}},or={key:0,class:"table table-browser gameBrowserList mb"},ir={key:0,width:"28"},nr=["href"],ar=["src","width","height"],lr={class:"line-normal"},dr=["href"],ur=s("br",null,null,-1),mr={key:0,class:"text-muted hide-sm"},cr={key:1,class:"hide-sm"},hr={key:2,class:"hide-sm"},fr={key:0,"data-tooltip":"Critic Score"},pr={key:1,"data-tooltip":"Critic Score"},gr={key:3,class:"hide-sm"},_r={key:0,"data-tooltip":"User Score"},vr={key:1,"data-tooltip":"User Score"},yr={key:4,class:"hide-sm"},wr={key:0,"data-tooltip":"Date Added"},br={key:5,class:"hide-sm"},kr={key:0,"data-tooltip":"Date Modified"},Pr={class:"hide-sm"},Sr={class:"hide-sm"},Dr={key:1},Cr=s("b",{class:"text-danger"},"No games found with the selected parameters.",-1),Ur=[Cr],xr={key:2,class:"no-select text-muted"},Rr={key:0,class:"text-disabled"},Lr={key:2,class:"text-disabled"},Vr={key:3,class:"mb-0"},Ir=s("a",{href:"/user/login/"},"Login",-1);function Tr(e,t,d,u,r,a){return i(),l("div",null,[r.total>0?(i(),l("table",or,[s("tbody",null,[(i(!0),l(b,null,N(r.games,m=>(i(),l("tr",{key:m.game_id},[d.showIcons?(i(),l("td",ir,[s("a",{href:m.internal_url,class:"flex flex-center"},[m.cover!==null?(i(),l("img",{key:0,src:m.cover.tiny_url,width:m.cover.tiny_width,height:m.cover.tiny_height,alt:"game thumbnail",class:_(["img-thumbnail-box img-thumbnail-md",{"img-thumbnail-sm":!d.showPlatforms}])},null,10,ar)):(i(),l("span",{key:1,class:_(["icon icon-game",{"icon-game-sm":!d.showPlatforms}])},null,2))],8,nr)])):c("",!0),s("td",lr,[s("a",{href:m.internal_url},h(a.truncateTitle(m.title)),9,dr),ur,d.showPlatforms?(i(),l("small",mr,h(a.getPlatformNames(m.platforms)),1)):c("",!0)]),r.pagingParams.sort==="moby_score"||r.pagingParams.sort==="-moby_score"?(i(),l("td",cr,[r.selectedPlatforms.length===1&&m.platforms.find(o=>o.id===r.selectedPlatforms[0])&&m.platforms.find(o=>o.id===r.selectedPlatforms[0]).moby_score?(i(),l("div",{key:0,class:"mobyscore",style:M(a.mobyScoreStyle(m.platforms.find(o=>o.id===r.selectedPlatforms[0]).moby_score)),"data-tooltip":"Moby Score"},h(m.platforms.find(o=>o.id===r.selectedPlatforms[0]).moby_score.toFixed(1)),5)):r.selectedPlatforms.length!==1&&m.moby_score?(i(),l("div",{key:1,class:"mobyscore",style:M(a.mobyScoreStyle(m.moby_score)),"data-tooltip":"Moby Score"},h(m.moby_score.toFixed(1)),5)):(i(),l("div",{key:2,class:"mobyscore",style:M(a.mobyScoreStyle(0)),"data-tooltip":"Not enough reviews available to compute a Moby Score"}," ... ",4))])):c("",!0),r.pagingParams.sort==="critic_score"||r.pagingParams.sort==="-critic_score"?(i(),l("td",hr,[r.selectedPlatforms.length===1&&m.platforms.find(o=>o.id===r.selectedPlatforms[0])&&m.platforms.find(o=>o.id===r.selectedPlatforms[0]).critic_score?(i(),l("div",fr,h(m.platforms.find(o=>o.id===r.selectedPlatforms[0]).critic_score.toFixed())+"% ",1)):r.selectedPlatforms.length!==1&&m.critic_score?(i(),l("div",pr,h(m.critic_score.toFixed())+"% ",1)):c("",!0)])):c("",!0),r.pagingParams.sort==="user_score"||r.pagingParams.sort==="-user_score"?(i(),l("td",gr,[r.selectedPlatforms.length===1&&m.platforms.find(o=>o.id===r.selectedPlatforms[0])&&m.platforms.find(o=>o.id===r.selectedPlatforms[0]).user_score?(i(),l("div",_r,h(m.platforms.find(o=>o.id===r.selectedPlatforms[0]).user_score.toFixed(1)),1)):r.selectedPlatforms.length!==1&&m.user_score?(i(),l("div",vr,h(m.user_score.toFixed(1)),1)):c("",!0)])):c("",!0),r.pagingParams.sort==="added"||r.pagingParams.sort==="-added"?(i(),l("td",yr,[m.created?(i(),l("div",wr,h(m.created),1)):c("",!0)])):c("",!0),r.pagingParams.sort==="modified"||r.pagingParams.sort==="-modified"?(i(),l("td",br,[m.last_modified?(i(),l("div",kr,h(m.last_modified),1)):c("",!0)])):c("",!0),s("td",Pr,[r.selectedPlatforms.length>0?(i(),l(b,{key:0},[p(h(a.getReleaseDates(m.platforms)),1)],64)):(i(),l(b,{key:1},[p(h(m.release_date),1)],64))]),s("td",Sr,h(a.getDeveloperName(m.companies)),1)]))),128))])])):(i(),l("p",Dr,Ur)),a.showPaging?(i(),l("p",xr,[p(" [ "),r.page<=1?(i(),l("span",Rr,"Prev")):(i(),l("a",{key:1,href:"#",onClick:t[0]||(t[0]=v(m=>a.fetchPage(r.page-1,!0),["prevent"])),rel:"nofollow"},"Prev")),p(" ] [ "),r.page===a.numPages?(i(),l("span",Lr,"Next")):(i(),l("a",{key:3,href:"#",onClick:t[1]||(t[1]=v(m=>a.fetchPage(r.page+1,!0),["prevent"])),rel:"nofollow"},"Next")),p(" ] [ Page "+h(r.page)+" "+h(a.totalPagesLabel)+" ] [ "+h(r.total.toLocaleString())+h(r.total===1e4?"+":"")+" results ] ",1)])):c("",!0),a.showPaging&&r.page>=r.maxPages?(i(),l("p",Vr,[r.maxPages<26?(i(),l(b,{key:0},[p(" Max paging limit reached. "),Ir,p(" to double the limit (or unlimited if you're an active contributor). ")],64)):(i(),l(b,{key:1},[p(" Max paging limit reached. Increase to unlimited by earning 50+ points of contributions within the past year. ")],64))])):c("",!0)])}const Er=O(rr,[["render",Tr]]),Or={mixins:[le],data(){return{narrow:this.initialValues.narrow,companySearchLoading:!1,companyOptions:this.initialValues.narrow.companies,groupOptions:this.initialValues.narrow.groups,submitDisabled:!1,fetching:!1,showComponent:"game-browser-list",showList:!0,showIcons:Y("showIcons")?Y("showIcons")==="true":!0,showPlatforms:Y("showPlatforms")?Y("showPlatforms")==="true":!1,gamesList:this.initialValues,yearOptionsReversed:[]}},components:{Alert:z,GameBrowserList:Er},props:["actionUrl","csrfToken","companySearchUrl","groupSearchUrl","genreIndexUrl","groupIndexUrl","attributeIndexUrl","initialValues","searchParams","allPlatforms","allGenres"],setup(e,t){return U({...e,initialValues:{title:e.searchParams.title,platform:e.searchParams.platform,genres:e.searchParams.genres,company:e.searchParams.company,groups:e.searchParams.groups,year:e.searchParams.year,endyear:e.searchParams.endyear,sort:e.searchParams.order_by,perpage:e.initialValues.perPage,min_critic_votes:e.initialValues.min_critic_votes,min_user_votes:e.initialValues.min_user_votes}},t)},mounted(){window.addEventListener("popstate",this.onPopState)},beforeUnmount(){window.removeEventListener("popstate",this.onPopState)},computed:{yearOptions(){return[...Array(this.narrow.max_year-this.narrow.min_year+1).keys()].map(e=>e+this.narrow.min_year)}},methods:{onTitleChange:Z.exports.debounce(function(){this.$nextTick(()=>{this.fetchGames(!0)})},500),onChange(e=null){this.$nextTick(()=>{e==="year"&&(this.formData.endyear===null||this.formData.endyear<this.formData.year)&&(this.formData.endyear=this.formData.year),G("minCriticRatings",this.formData.min_critic_votes),G("minUserRatings",this.formData.min_user_votes),G("perPage",this.formData.perpage),G("browserSort",this.formData.sort),this.fetchGames(!0)})},toggleIconDisplay(){this.showIcons=!this.showIcons,G("showIcons",this.showIcons)},togglePlatformDisplay(){this.showPlatforms=!this.showPlatforms,G("showPlatforms",this.showPlatforms)},findCompany:Z.exports.debounce(async function(t,d){if(t===null||t==="")return;this.submitDisabled=!0,d(!0),await this.onSubmit(this.companySearchUrl,{query:t})?(this.companyOptions=this.result.data.items.map(r=>({id:r.id,name:r.name,company_id:r.company_id})),d(!1),this.submitDisabled=!1):this.companyOptions=[]},500),findGroup:Z.exports.debounce(async function(t,d){if(t===null||t==="")return;this.submitDisabled=!0,d(!0),await this.onSubmit(this.groupSearchUrl,{query:t})?(this.groupOptions=this.groupOptions.filter(r=>this.formData.groups.includes(r)).concat(this.result.data.items),d(!1),this.submitDisabled=!1):(this.groupOptions=[],d(!1))},500),async fetchGames(e){this.submitDisabled=!0,this.showList=!1,this.showComponent=null,this.fetching=!0,await this.onSubmit(this.actionUrl,this.formData)?(e&&(window.current_state_id=window.current_state_id||0,window.max_state_id=window.max_state_id||0,window.history.pushState(JSON.stringify({params:{...this.formData,page:1,id:window.max_state_id+1}}),"",this.result.data.newUrl)),this.gamesList=this.result.data,this.result.data.narrow!==null&&(this.narrow=this.result.data.narrow,this.groupOptions=this.groupOptions.filter(d=>this.formData.groups.includes(d.id)).concat(this.narrow.groups.filter(d=>!this.formData.groups.includes(d.id))),this.companyOptions=this.companyOptions.filter(d=>this.formData.company===d).concat(this.narrow.companies)),this.fetching=!1,this.showList=!0,this.showComponent="game-browser-list",this.fetching=!1,this.submitDisabled=!1):(this.gamesList=[],this.fetching=!1,this.submitDisabled=!1)},onPopState(e){if(e.state===null)return;const t=JSON.parse(e.state);"params"in t&&(this.formData=t.params,this.fetchGames())}}},$r={class:"browser-grid mb"},Ar={id:"form-game-browser",class:"mb"},Nr={class:"form-group"},Br={key:0},Mr={key:1},qr={key:0},Hr={key:1},Gr={class:"form-group"},jr={class:"loading"},Fr={class:"form-group"},Jr={key:0},Yr={key:1},Kr={key:0},zr={key:1},Zr={class:"form-group"},Qr={class:"loading"},Wr={class:"form-inline"},Xr={class:"form-group me",style:{flex:"1"}},eo={class:"form-group",style:{flex:"1"}},to={class:"form-group"},so={class:"form-group"},ro={key:0,class:"form-group flex flex-center"},oo=s("div",{class:"text-sm text-nowrap me-sm"}," Min. Critic Ratings ",-1),io={key:1,class:"form-group flex flex-center"},no=s("div",{class:"text-sm text-nowrap me-sm"}," Min. Player Ratings ",-1),ao={class:"form-group hide-sm"},lo={class:"hide-sm"},uo=s("b",{class:"text-muted"},"Display Settings",-1),mo=s("br",null,null,-1),co=s("br",null,null,-1),ho=s("p",{class:"text-muted"},[s("b",null,"Hotkeys"),s("br"),s("small",null,[p(" Left Arrow (Prev)"),s("br"),p(" Right Arrow (Next) ")])],-1),fo=s("b",{class:"text-muted"},"Also Browse",-1),po=s("br",null,null,-1),go=["href"],_o=["href"],vo={key:0,class:"loading"};function yo(e,t,d,u,r,a){const m=T("v-select");return i(),l("div",$r,[s("div",null,[s("form",Ar,[s("div",Nr,[L(m,{"onUpdate:modelValue":[a.onChange,t[0]||(t[0]=o=>e.formData.platform=o)],name:"platform",modelValue:e.formData.platform,multiple:!0,options:d.allPlatforms.filter(o=>this.narrow.platforms.includes(o.id)||this.formData.platform.includes(o.id)),reduce:o=>o.id,selectable:o=>!this.formData.platform.includes(o.id),label:"name",placeholder:"All Platforms"},{option:I(({name:o})=>[e.formData.platform.length===0?(i(),l("span",Br,h(o),1)):(i(),l("span",Mr,"or "+h(o),1))]),"selected-option":I(({id:o,name:n})=>[e.formData.platform[0]===o?(i(),l("span",qr,h(n),1)):(i(),l("span",Hr,"or "+h(n),1))]),_:1},8,["onUpdate:modelValue","modelValue","options","reduce","selectable"])]),s("div",Gr,[L(m,{"onUpdate:modelValue":[a.onChange,t[1]||(t[1]=o=>e.formData.company=o)],name:"company",modelValue:e.formData.company,options:r.companyOptions,filterable:!1,label:"name",placeholder:"All Companies",onSearch:a.findCompany},{"no-options":I(({search:o,searching:n,loading:V})=>[p(" type to search... ")]),spinner:I(({loading:o})=>[g(s("div",jr,"Loading",512),[[oe,o]])]),_:1},8,["onUpdate:modelValue","modelValue","options","onSearch"])]),s("div",Fr,[L(m,{"onUpdate:modelValue":[a.onChange,t[2]||(t[2]=o=>e.formData.genres=o)],name:"genres",modelValue:e.formData.genres,multiple:!0,options:d.allGenres.reduce((o,n)=>o.concat(n.genres),[]).filter(o=>this.narrow.genres.includes(o.id)||this.formData.genres.includes(o.id)),reduce:o=>o.id,selectable:o=>!this.formData.genres.includes(o.id),label:"name",placeholder:"All Genres"},{option:I(({name:o})=>[e.formData.genres.length===0?(i(),l("span",Jr,h(o),1)):(i(),l("span",Yr,"and "+h(o),1))]),"selected-option":I(({id:o,name:n})=>[e.formData.genres[0]===o?(i(),l("span",Kr,h(n),1)):(i(),l("span",zr,"and "+h(n),1))]),_:1},8,["onUpdate:modelValue","modelValue","options","reduce","selectable"])]),s("div",Zr,[L(m,{"onUpdate:modelValue":[a.onChange,t[3]||(t[3]=o=>e.formData.groups=o)],name:"groups",modelValue:e.formData.groups,options:r.groupOptions,multiple:!0,reduce:o=>o.id,filterable:!1,selectable:o=>!this.formData.groups.includes(o.id),label:"name",placeholder:"All Game Groups",onSearch:a.findGroup},{"no-options":I(({search:o,searching:n,loading:V})=>[p(" type to search... ")]),spinner:I(({loading:o})=>[g(s("div",Qr,"Loading",512),[[oe,o]])]),_:1},8,["onUpdate:modelValue","modelValue","options","reduce","selectable","onSearch"])]),s("div",Wr,[s("div",Xr,[L(m,{"onUpdate:modelValue":[t[4]||(t[4]=o=>a.onChange("year")),t[5]||(t[5]=o=>e.formData.year=o)],name:"year",modelValue:e.formData.year,options:a.yearOptions.filter(o=>r.narrow.min_year<=o&&r.narrow.max_year>=o),placeholder:"From"},null,8,["modelValue","options"])]),s("div",eo,[L(m,{"onUpdate:modelValue":[a.onChange,t[6]||(t[6]=o=>e.formData.endyear=o)],name:"endyear",modelValue:e.formData.endyear,options:a.yearOptions.filter(o=>r.narrow.min_year<=o&&r.narrow.max_year>=o),placeholder:"Until"},null,8,["onUpdate:modelValue","modelValue","options"])])]),s("div",to,[g(s("input",{type:"text",class:"form-input",onInput:t[7]||(t[7]=(...o)=>a.onTitleChange&&a.onTitleChange(...o)),name:"title","onUpdate:modelValue":t[8]||(t[8]=o=>e.formData.title=o),placeholder:"Title",maxlength:"50"},null,544),[[w,e.formData.title]])]),s("div",so,[L(m,{"onUpdate:modelValue":[a.onChange,t[9]||(t[9]=o=>e.formData.sort=o)],name:"sort",modelValue:e.formData.sort,label:"name",options:[{id:"title",name:"Alphabetical (a\u2192z)"},{id:"-title",name:"Alphabetical (z\u2192a)"},{id:"added",name:"Date Added (newest)"},{id:"-added",name:"Date Added (oldest)"},{id:"critic_score",name:"Critic Score (best)"},{id:"-critic_score",name:"Critic Score (worst)"},{id:"moby_score",name:"Moby Score (best)"},{id:"-moby_score",name:"Moby Score (worst)"},{id:"user_score",name:"Player Score (best)"},{id:"-user_score",name:"Player Score (worst)"},{id:"date",name:"Release Date (oldest)"},{id:"-date",name:"Release Date (newest)"},{id:"modified",name:"Updated (newest)"},{id:"-modified",name:"Updated (oldest)"}],reduce:o=>o.id,clearable:!1},null,8,["onUpdate:modelValue","modelValue","options","reduce"])]),e.formData.sort=="critic_score"||e.formData.sort=="-critic_score"?(i(),l("div",ro,[oo,s("div",null,[g(s("input",{type:"number",class:"form-input",onInput:t[10]||(t[10]=(...o)=>a.onChange&&a.onChange(...o)),name:"min_critic_votes","onUpdate:modelValue":t[11]||(t[11]=o=>e.formData.min_critic_votes=o),placeholder:"Min. Critic Scores",min:"1"},null,544),[[w,e.formData.min_critic_votes]])])])):c("",!0),e.formData.sort=="user_score"||e.formData.sort=="-user_score"?(i(),l("div",io,[no,s("div",null,[g(s("input",{type:"number",class:"form-input form-input-sm",onInput:t[12]||(t[12]=(...o)=>a.onChange&&a.onChange(...o)),name:"min_user_votes","onUpdate:modelValue":t[13]||(t[13]=o=>e.formData.min_user_votes=o),placeholder:"Min. Player Ratings",min:"1"},null,544),[[w,e.formData.min_user_votes]])])])):c("",!0),s("div",ao,[L(m,{"onUpdate:modelValue":[a.onChange,t[14]||(t[14]=o=>e.formData.perpage=o)],name:"perPage",modelValue:e.formData.perpage,label:"name",options:[{id:12,name:"12 Results Per Page"},{id:18,name:"18 Results Per Page"},{id:24,name:"24 Results Per Page"},{id:30,name:"30 Results Per Page"},{id:40,name:"40 Results Per Page"},{id:50,name:"50 Results Per Page"}],reduce:o=>o.id,clearable:!1},null,8,["onUpdate:modelValue","modelValue","reduce"])])]),s("div",lo,[s("p",null,[uo,mo,s("a",{href:"#",onClick:t[15]||(t[15]=(...o)=>a.toggleIconDisplay&&a.toggleIconDisplay(...o))},[p(" Icons "),s("span",{class:_(["icon",{"icon-toggle-on":r.showIcons,"icon-toggle-off":!r.showIcons}])},null,2)]),co,s("a",{href:"#",onClick:t[16]||(t[16]=(...o)=>a.togglePlatformDisplay&&a.togglePlatformDisplay(...o))},[p(" Platforms "),s("span",{class:_(["icon",{"icon-toggle-on":r.showPlatforms,"icon-toggle-off":!r.showPlatforms}])},null,2)])]),ho,s("p",null,[fo,po,s("a",{href:d.attributeIndexUrl},"Attributes",8,go),p(", "),s("a",{href:d.groupIndexUrl},"Groups",8,_o)])])]),r.fetching?(i(),l("div",vo,"Loading")):c("",!0),r.showList?(i(),k(X(r.showComponent),{key:1,"initial-values":r.gamesList,"paging-method":"POST","show-icons":r.showIcons,"show-platforms":r.showPlatforms,"initial-paging-params":e.formData},null,8,["initial-values","show-icons","show-platforms","initial-paging-params"])):c("",!0)])}const wo=O(Or,[["render",yo]]),bo={props:{prevUrl:{type:String,default:""},nextUrl:{type:String,default:""}},mounted(){window.addEventListener("keyup",e=>{this.onHotkey(e.code)})},methods:{onHotkey(e){switch(e){case"ArrowLeft":window.location.href=this.prevUrl;break;case"ArrowRight":window.location.href=this.nextUrl;break}}}},ko={class:"text-muted text-sm text-left"},Po=s("b",null,"HOTKEYS",-1),So=s("br",null,null,-1),Do=s("br",null,null,-1);function Co(e,t,d,u,r,a){return i(),l("div",ko,[Po,So,p(" Left Arrow (Prev)"),Do,p(" Right Arrow (Next) ")])}const Uo=O(bo,[["render",Co]]),xo={props:{id:{type:Number},origName:{type:String},origDescription:{type:String},origPrivate:{type:Boolean},purchasePrivate:{type:Boolean},isOwner:{type:Boolean},csrfToken:{type:String},editUrl:{type:String},addItemUrl:{type:String},deleteItemUrl:{type:String},searchUrl:{type:String},games:{type:Array},collectionUrl:{type:String},fetchUrl:{type:String},total:{type:Number},perPage:{type:Number},order:{type:String}},data(){return{loading:!1,list:this.games,sortBy:this.order,hasBuyInfo:!1,hasComments:!1,page:1,numPages:Math.ceil(this.total/this.perPage),totalGames:this.total,transitionName:"none",editing:!1,dirty:!1,description:this.origDescription,name:this.origName,private:this.origPrivate,oldName:this.origDescription,oldDescription:this.origName,oldPrivate:this.origPrivate}},created(){const e=JSON.parse(localStorage.getItem("game-list-settings"));e&&(this.sortBy=e.sort)},mounted(){(this.list.some(e=>e.purchase_date)||this.list.some(e=>e.purchase_price))&&(this.hasBuyInfo=!0),this.list.some(e=>e.comments)&&(this.hasComments=!0)},computed:{totalPagesLabel(){return`of ${this.numPages}`},showPaging(){return this.numPages>1}},watch:{name(){this.dirty=!0},description(){this.dirty=!0},private(){this.dirty=!0}},methods:{sort(e){e===this.sortBy&&(e=e.startsWith("-")?e.substring(1):`-${e}`),this.sortBy=e,localStorage.setItem("game-list-settings",JSON.stringify({sort:this.sortBy})),this.fetchPage(1)},toggleEdit(){this.editing=!this.editing,this.editing?(this.oldName=this.name,this.oldDescription=this.description,this.oldPrivate=this.private,this.dirty=!1):(this.name=this.oldName,this.description=this.oldDescription,this.private=this.oldPrivate)},async saveEdit(){const{result:e,onSubmit:t}=U(this.$props),d={_csrf_token:this.csrfToken,id:this.id,name:this.name,private:this.private,purchase_private:this.purchasePrivate,description:this.description,object_class:"HaveList"};await t(this.editUrl,d,!1,!1,!1)?(this.editing=!1,this.dirty=!1):console.error(e.errors)},addItemToList(e){this.list.unshift(e),this.totalGames+=1},async fetchPage(e,t=!0){if(e<1||e>=this.numPages+1||this.loadingPage)return;this.loading=!0;const{result:d,onSubmit:u}=U(this.$props);await u(this.fetchUrl,{page:e,sort:this.sortBy})?(this.list=d.data.games,this.page=d.data.page,t&&(window.current_state_id=window.current_state_id||0,window.max_state_id=window.max_state_id||0,window.history.pushState(JSON.stringify({page:e,sort:this.sortBy}),"",d.data.url)),this.loading=!1):(console.error(d.errors),this.loading=!1)},onPopState(e){e.state!==null&&("page"in e.state&&(this.page=e.state.page),"sort"in e.state&&(this.sortBy=e.state.sort),this.fetchPage(this.page,!1),window.current_state_id=e.state.id)},async doDelete(e){if(this.loading)return;this.loading=!0;const{result:t,onSubmit:d}=U(this.$props);if(await d(this.deleteItemUrl,{id:e})){const r=this.list.find(({id:a})=>a===e);r&&(this.list=this.list.filter(a=>a!==r)),this.loading=!1}else console.error(t.errors),this.loading=!1}}},Ro=["href"],Lo={class:"text-muted"},Vo={class:"text-normal"},Io={key:0},To={key:1,class:"bg-highlight border border-sm mb"},Eo={class:"form-group"},Oo=s("small",null,"List Title",-1),$o={class:"form-group"},Ao=s("small",null,"List Description",-1),No={class:"form-group"},Bo={class:"form-checkbox"},Mo=["disabled"],qo={class:"mb"},Ho=s("summary",{class:"no-select text-primary"},"Add Game to List",-1),Go={class:"overflow-x-scroll"},jo={key:0,class:"table table-striped mb"},Fo={class:"text-center"},Jo={class:"text-center"},Yo={class:"text-center"},Ko={class:"text-center"},zo={key:0},Zo={key:1},Qo={key:2,class:"text-center"},Wo={class:"td-nowrap text-ellipsis",style:{"max-width":"300px"}},Xo=["href"],ei=["src","width","height"],ti={key:1,class:"icon icon-game icon-game-sm display-inline vertical-align-middle"},si=["href"],ri={class:"text-center td-nowrap"},oi=["data-tooltip"],ii=["href"],ni={key:0,class:"text-center td-nowrap"},ai=["href"],li={key:1,class:"text-center","data-tooltip":"Not reviewed yet"},di=s("span",{class:"stars stars-sm",style:{"--rating":"0"}},null,-1),ui=[di],mi={class:"text-center"},ci=["href"],hi=["href"],fi={class:"text-center"},pi=["href"],gi=["href"],_i={key:2,class:"text-sm"},vi={key:3,style:{"max-width":"300px"}},yi={key:4,class:"text-center td-nowrap"},wi=["href"],bi=["onClick"],ki={colspan:"6"},Pi={key:0,class:"no-select text-muted"},Si={key:0,class:"text-disabled"},Di={key:2,class:"text-disabled"};function Ci(e,t,d,u,r,a){const m=T("search");return i(),l("div",null,[s("p",null,[s("b",null,[s("a",{href:d.collectionUrl},"Collection",8,Ro),p(" > "+h(r.name),1)]),s("span",Lo," ("+h(r.totalGames)+" games) ("+h(r.private?"private":"public")+" list) ",1),s("span",Vo,[d.isOwner&&!r.editing?(i(),l(b,{key:0},[p(" [ "),s("a",{href:"#",onClick:t[0]||(t[0]=o=>a.toggleEdit()),class:"text-danger"}," edit "),p(" ] ")],64)):c("",!0),d.isOwner&&r.editing?(i(),l(b,{key:1},[p(" [ "),s("a",{href:"#",onClick:t[1]||(t[1]=o=>a.toggleEdit()),class:"text-danger"}," cancel "),p(" ] ")],64)):c("",!0)])]),r.description?(i(),l("p",Io,h(r.description),1)):c("",!0),r.editing?(i(),l("div",To,[s("div",Eo,[Oo,g(s("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>r.name=o),onKeyup:t[3]||(t[3]=F(o=>a.saveEdit(),["enter"])),class:"form-input",placeholder:"List name",minlength:"1",maxlength:"40",required:""},null,544),[[w,r.name]])]),s("div",$o,[Ao,g(s("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>r.description=o),onKeyup:t[5]||(t[5]=F(o=>a.saveEdit(),["enter"])),class:"form-input",placeholder:"Description (optional)",maxlength:"255"},null,544),[[w,r.description]])]),s("div",No,[s("label",Bo,[g(s("input",{name:"private",type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=o=>r.private=o)},null,512),[[B,r.private]]),p(" Private ")])]),s("div",null,[s("button",{onClick:t[7]||(t[7]=o=>a.saveEdit()),class:_(["btn btn-sm",{"btn-primary":r.dirty}]),disabled:r.dirty===!1},"Save",10,Mo)])])):c("",!0),s("details",qo,[Ho,d.isOwner?(i(),k(m,{key:0,"csrf-token":d.csrfToken,"add-item-url":d.addItemUrl,"a-url":d.searchUrl,"game-only":!0,"is-add-to-list":!0,"list-id":d.id,onAddItemToList:a.addItemToList,class:"mb",placeholder:"Search for game to add..."},null,8,["csrf-token","add-item-url","a-url","list-id","onAddItemToList"])):c("",!0)]),s("div",Go,[r.list.length>0?(i(),l("table",jo,[s("thead",null,[s("tr",null,[s("th",null,[s("a",{href:"#",onClick:t[8]||(t[8]=v(o=>a.sort("title"),["prevent"]))},"Title"),r.sortBy==="title"||r.sortBy==="-title"?(i(),l("span",{key:0,class:_(["arrow ms-1",{"arrow-down":r.sortBy==="title","arrow-up":r.sortBy==="-title"}])},null,2)):c("",!0)]),s("th",Fo,[s("a",{href:"#",onClick:t[9]||(t[9]=v(o=>a.sort("platform"),["prevent"]))},"Platform"),r.sortBy==="platform"||r.sortBy==="-platform"?(i(),l("span",{key:0,class:_(["arrow ms-1",{"arrow-down":r.sortBy==="platform","arrow-up":r.sortBy==="-platform"}])},null,2)):c("",!0)]),s("th",Jo,[s("a",{href:"#",onClick:t[10]||(t[10]=v(o=>a.sort("rating"),["prevent"]))},"Review"),r.sortBy==="rating"||r.sortBy==="-rating"?(i(),l("span",{key:0,class:_(["arrow ms-1",{"arrow-down":r.sortBy==="rating","arrow-up":r.sortBy==="-rating"}])},null,2)):c("",!0)]),s("th",Yo,[s("a",{href:"#",onClick:t[11]||(t[11]=v(o=>a.sort("used_price"),["prevent"]))},"Used"),r.sortBy==="used_price"||r.sortBy==="-used_price"?(i(),l("span",{key:0,class:_(["arrow ms-1",{"arrow-down":r.sortBy==="used_price","arrow-up":r.sortBy==="-used_price"}])},null,2)):c("",!0)]),s("th",Ko,[s("a",{href:"#",onClick:t[12]||(t[12]=v(o=>a.sort("new_price"),["prevent"]))},"New"),r.sortBy==="new_price"||r.sortBy==="-new_price"?(i(),l("span",{key:0,class:_(["arrow ms-1",{"arrow-down":r.sortBy==="new_price","arrow-up":r.sortBy==="-new_price"}])},null,2)):c("",!0)]),r.hasBuyInfo&&(d.isOwner||!d.purchasePrivate)?(i(),l("th",zo,"Buy Info")):c("",!0),r.hasComments?(i(),l("th",Zo,"Comments")):c("",!0),d.isOwner?(i(),l("th",Qo,"Manage")):c("",!0)])]),L(ie,{name:r.transitionName,tag:"tbody"},{default:I(()=>[(i(!0),l(b,null,N(r.list,o=>(i(),l("tr",{key:o.id},[s("td",Wo,[o.cover?(i(),l("a",{key:0,href:o.game_url},[s("img",{src:o.cover.url,width:o.cover.width,height:o.cover.height,alt:"cover",class:"img-thumbnail-box img-thumbnail-sm"},null,8,ei)],8,Xo)):(i(),l("span",ti)),p(" \xA0"),s("a",{href:o.game_url},h(o.game_title),9,si)]),s("td",ri,h(o.platform),1),o.rating.rating?(i(),l("td",{key:0,class:"text-center","data-tooltip":`${o.rating.rating} stars`},[s("a",{href:o.rating.url},[s("span",{class:"stars stars-sm",style:M(`--rating: ${o.rating.rating}`)},null,4)],8,ii)],8,oi)):(i(),l(b,{key:1},[d.isOwner?(i(),l("td",ni,[p(" [ "),s("a",{href:o.game_url},"review",8,ai),p(" ] ")])):(i(),l("td",li,ui))],64)),s("td",mi,[o.used_price?(i(),l("a",{key:0,href:o.ebay_url,target:"_blank",class:"link-external"},h(o.used_price),9,ci)):o.ebay_url?(i(),l("a",{key:1,href:o.ebay_url,target:"_blank",class:"link-external"},"check",8,hi)):c("",!0)]),s("td",fi,[o.new_price?(i(),l("a",{key:0,href:o.ebay_url,target:"_blank",class:"link-external"},h(o.new_price),9,pi)):o.ebay_url?(i(),l("a",{key:1,href:o.ebay_url,target:"_blank",class:"link-external"},"check",8,gi)):c("",!0)]),r.hasBuyInfo&&(d.isOwner||!d.purchasePrivate)?(i(),l("td",_i,[o.purchase_price?(i(),l(b,{key:0},[p(" $"+h(o.purchase_price),1)],64)):c("",!0),o.purchase_date?(i(),l(b,{key:1},[p(" ("+h(o.purchase_date)+") ",1)],64)):c("",!0)])):c("",!0),r.hasComments?(i(),l("td",vi,h(o.comments),1)):c("",!0),d.isOwner?(i(),l("td",yi,[p(" [ "),s("a",{href:o.edit_url},"edit",8,wi),p(" ] [ "),s("a",{href:"#",onClick:v(n=>a.doDelete(o.id),["prevent"])},"delete",8,bi),p(" ] ")])):c("",!0)]))),128))]),_:1},8,["name"]),s("tr",null,[s("td",ki,[a.showPaging?(i(),l("p",Pi,[p(" [ "),r.page<=1?(i(),l("span",Si,"Prev")):(i(),l("a",{key:1,href:"#",onClick:t[13]||(t[13]=v(o=>a.fetchPage(r.page-1),["prevent"]))},"Prev")),p(" ] [ "),r.page===r.numPages?(i(),l("span",Di,"Next")):(i(),l("a",{key:3,href:"#",onClick:t[14]||(t[14]=v(o=>a.fetchPage(r.page+1),["prevent"]))},"Next")),p(" ] [ Page "+h(r.page)+" "+h(a.totalPagesLabel)+" ] [ "+h(r.totalGames.toLocaleString())+h(r.totalGames===1e4?"+":"")+" games ] ",1)])):c("",!0)])])])):c("",!0)])])}const Ui=O(xo,[["render",Ci]]),xi={props:{owner:{type:Boolean},csrfToken:{type:String},userLists:{type:Array},actionUrl:{type:String},editUrl:{type:String},deleteUrl:{type:String},importUrl:{type:String}},data(){return{loading:!1,importing:!1,deleteId:-1,editId:-1,lists:this.userLists,sortBy:"name",descOrder:!0,title:"",description:"",privateList:!1,privatePurchase:!1,modal:!1,modalBodyText:"",hasFilesToUpload:!1}},created(){const e=JSON.parse(localStorage.getItem("collection-settings"));e&&(this.sortBy=e.sort,this.descOrder=e.order)},computed:{sortedList(){return this.editId>-1?this.lists:this.sortBy==="games"?this.descOrder?this.lists.sort((e,t)=>e.games.length-t.games.length):this.lists.sort((e,t)=>t.games.length-e.games.length):this.sortBy==="name"?this.lists.sort((e,t)=>{const d=this.descOrder?e.name.toUpperCase():t.name.toUpperCase(),u=this.descOrder?t.name.toUpperCase():e.name.toUpperCase();return d<u?-1:d>u?1:0}):this.lists}},methods:{sort(e){e===this.sortBy&&(this.descOrder=!this.descOrder),this.sortBy=e,localStorage.setItem("collection-settings",JSON.stringify({sort:this.sortBy,order:this.descOrder}))},importCheck(){this.$refs.upload.files&&(this.hasFilesToUpload=!0)},async importLists(){if(this.importing)return;this.importing=!0;const e=new FormData,{files:t}=this.$refs.upload;[...t].forEach(a=>{e.append("files",a)}),e.append("_csrf_token",this.csrfToken);const{result:d,onSubmit:u}=U(this.$props);await u(this.importUrl,e,!1,!0)?([...d.data.lists].forEach(a=>{this.lists.unshift(a)}),this.importing=!1):(this.modal=!0,this.modalBodyText=d.errors.SERVER_ERROR,this.importing=!1)},async add(){const{result:e,onSubmit:t}=U(this.$props),d={_csrf_token:this.csrfToken,name:this.title,description:this.description,private:this.privateList,purchase_private:this.privatePurchase};await t(this.actionUrl,d)?(this.title="",this.description="",this.lists.unshift(e.data.list),this.loading=!1):(this.modal=!0,this.modalBodyText=e.errors.SERVER_ERROR,this.loading=!1)},editMode(e){this.editId=e.id},cancelEdit(){this.editId=-1},async saveEdit(e){const{result:t,onSubmit:d}=U(this.$props),u={_csrf_token:this.csrfToken,id:e.id,name:e.name,description:e.description,private:e.private,object_class:"HaveList",purchase_private:e.purchase_private};await d(this.editUrl,u,!1,!1,!1)?this.cancelEdit():(this.modal=!0,this.modalBodyText=t.errors.SERVER_ERROR)},cancelDelete(){this.deleteId=-1},deleteRequest(e){this.deleteId=e},async deleteList(e){const{result:t,onSubmit:d}=U(this.$props),u={_csrf_token:this.csrfToken,id:e};if(await d(this.deleteUrl,u)){const a=this.lists.find(({id:m})=>m===e);a&&(this.lists=this.lists.filter(m=>m!==a))}else this.modal=!0,this.modalBodyText=t.errors.SERVER_ERROR,this.cancelDelete()}}},Ri={class:"mb"},Li={key:0,class:"mb-sm"},Vi=s("summary",{class:"no-select text-primary"},"Create or Import List",-1),Ii=s("p",{class:"text-bold mb-xs"},"Create List",-1),Ti={class:"flex flex-gap"},Ei={class:"flex flex-center"},Oi={class:"form-checkbox me-sm text-nowrap"},$i={class:"bg-highlight border border-radius p-sm"},Ai=s("p",{class:"text-bold mb-xs"},"Import .csv file(s)",-1),Ni={key:0,class:"mt-sm mb-0"},Bi={class:"overflow-x-scroll"},Mi={key:0,class:"table table-striped mb"},qi=s("th",null,"Description",-1),Hi={key:0,class:"text-center"},Gi={class:"text-center"},ji={key:1},Fi=["onUpdate:modelValue","onKeyup"],Ji=["href"],Yi=["onUpdate:modelValue","onKeyup"],Ki={key:1},zi=["onUpdate:modelValue","onKeyup"],Zi=s("option",{value:!1},"public",-1),Qi=s("option",{value:!0},"private",-1),Wi=[Zi,Qi],Xi={key:1},en={class:"text-center"},tn={key:1,class:"td-nowrap"},sn={key:0,class:"text-nowrap"},rn=["onClick"],on=["onClick"],nn=["onClick"],an=["href"],ln={key:0},dn=["onClick"],un={key:1},mn=["onClick"],cn=s("h4",null,"Error",-1),hn=["innerHTML"],fn={class:"flex flex-gap"};function pn(e,t,d,u,r,a){const m=T("modal");return i(),l("div",Ri,[d.owner?(i(),l("div",Li,[s("details",null,[Vi,s("form",{onSubmit:t[3]||(t[3]=v((...o)=>a.add&&a.add(...o),["prevent"])),class:"bg-highlight border border-radius p-sm mt-sm mb-sm"},[Ii,s("div",Ti,[g(s("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>r.title=o),class:"form-input",placeholder:"List name",maxlength:"40",required:"",style:{width:"30%"}},null,512),[[w,r.title]]),g(s("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>r.description=o),class:"form-input",placeholder:"Description (optional)",maxlength:"255"},null,512),[[w,r.description]]),s("div",Ei,[s("label",Oi,[g(s("input",{name:"private",type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=o=>r.privateList=o)},null,512),[[B,r.privateList]]),p(" Private ")]),s("button",{class:_(["btn btn-primary",{disabled:r.loading}])},h(r.loading?"Adding...":"Add"),3)])])],32),s("div",$i,[Ai,s("input",{onChange:t[4]||(t[4]=(...o)=>a.importCheck&&a.importCheck(...o)),ref:"upload",type:"file",id:"csv",name:"file",accept:".csv",multiple:""},null,544),r.hasFilesToUpload?(i(),l("p",Ni,[s("button",{class:"btn btn-primary",onClick:t[5]||(t[5]=(...o)=>a.importLists&&a.importLists(...o))},h(r.importing?"Importing...":"Import"),1)])):c("",!0)])])])):c("",!0),s("div",Bi,[r.lists.length>0?(i(),l("table",Mi,[s("thead",null,[s("tr",null,[s("th",null,[s("a",{href:"#",onClick:t[6]||(t[6]=v(o=>a.sort("name"),["prevent"]))},"Name")]),qi,d.owner?(i(),l("th",Hi,"Privacy")):c("",!0),s("th",Gi,[s("a",{href:"#",onClick:t[7]||(t[7]=v(o=>a.sort("games"),["prevent"]))},"Games")]),d.owner?(i(),l("th",ji,"Manage")):c("",!0)])]),L(ie,{name:"list",tag:"tbody"},{default:I(()=>[(i(!0),l(b,null,N(a.sortedList,o=>(i(),l("tr",{class:_({"bg-notice":o.new}),key:o.id},[s("td",null,[o.id===r.editId?g((i(),l("input",{key:0,"onUpdate:modelValue":n=>o.name=n,onKeyup:F(n=>a.saveEdit(o),["enter"]),class:"form-input form-input-sm form-input-inline-edit",placeholder:"List name",maxlength:"40",required:""},null,40,Fi)),[[w,o.name]]):(i(),l("a",{key:1,href:o.internal_url},h(o.name),9,Ji))]),s("td",null,[o.id===r.editId?g((i(),l("input",{key:0,"onUpdate:modelValue":n=>o.description=n,onKeyup:F(n=>a.saveEdit(o),["enter"]),class:"form-input form-input-sm form-input-inline-edit",placeholder:"Description (optional)",maxlength:"255"},null,40,Yi)),[[w,o.description]]):(i(),l("span",Ki,h(o.description),1))]),d.owner?(i(),l("td",{key:0,class:_(["text-center",{"text-danger":o.private}])},[o.id===r.editId?g((i(),l("select",{key:0,"onUpdate:modelValue":n=>o.private=n,onKeyup:F(n=>a.saveEdit(o),["enter"]),class:"form-input-inline-edit text-sm",style:{padding:"0px"}},Wi,40,zi)),[[Q,o.private]]):(i(),l("span",Xi,h(o.private?"private":"public"),1))],2)):c("",!0),s("td",en,h(o.games.length),1),d.owner?(i(),l("td",tn,[o.id===r.editId?(i(),l("span",sn,[p(" [ "),s("a",{href:"#",onClick:t[8]||(t[8]=v((...n)=>a.cancelEdit&&a.cancelEdit(...n),["prevent"]))},"cancel"),p(" ] [ "),s("a",{href:"#",onClick:v(n=>a.saveEdit(o),["prevent"]),class:"text-success"},"save",8,rn),p(" ] ")])):(i(),l(b,{key:1},[o.id===r.deleteId?(i(),l(b,{key:0},[p(" Delete list? "),s("a",{href:"#",onClick:t[9]||(t[9]=v((...n)=>a.cancelDelete&&a.cancelDelete(...n),["prevent"]))},"no"),p(" \xB7 "),s("a",{href:"#",onClick:v(n=>a.deleteList(o.id),["prevent"]),class:"text-danger"},"yes",8,on)],64)):(i(),l(b,{key:1},[p(" [ "),s("a",{href:"#",onClick:v(n=>a.editMode(o),["prevent"])},"edit",8,nn),p(" ] [ "),s("a",{href:o.export_url},"export",8,an),p(" ] "),o.games.length>0?(i(),l("span",ln,[p("[ "),s("a",{href:"#",onClick:v(n=>a.deleteRequest(o.id),["prevent"]),class:"text-danger"},"x",8,dn),p(" ]")])):(i(),l("span",un,[p("[ "),s("a",{href:"#",onClick:v(n=>a.deleteList(o.id),["prevent"]),class:"text-danger"},"x",8,mn),p(" ]")]))],64))],64))])):c("",!0)],2))),128))]),_:1})])):c("",!0)]),L(m,{show:r.modal,onClose:t[11]||(t[11]=o=>r.modal=!1)},{header:I(()=>[cn]),body:I(()=>[s("span",{innerHTML:r.modalBodyText},null,8,hn)]),footer:I(()=>[s("div",fn,[s("button",{class:"btn btn-block",onClick:t[10]||(t[10]=o=>r.modal=!1)},"Ok")])]),_:1},8,["show"])])}const gn=O(xi,[["render",pn]]),_n={props:{authenticated:{type:Boolean,default:!1},userScore:{type:Number,default:0},userPlatform:{type:Number},userReviews:{type:Object},userLists:{type:Array},actionUrl:{type:String},listActionUrl:{type:String},listAddUrl:{type:String},playlistUrl:{type:String},loginUrl:{type:String},csrfToken:{type:String},platforms:{type:Array},gameId:{type:Number},userId:{type:Number},coverUrl:{type:String}},data(){return{starsStyle:{"--rating":this.mobyScore},displayedScore:this.userScore,originalReviews:null,reviews:Object.assign(Object.fromEntries(this.platforms.map(e=>[e.id,{rating:null,review_headline:"",review_good:"",review_bad:"",review_bottomline:"",dirty:!1,new:!0}])),this.userReviews),selectedPlatformId:this.userPlatform,selectedReviewPlatformId:this.userPlatform,hoverScore:0,isReviewing:!1,reviewed:!1,modal:!1,modalBodyText:"",numReviews:0,reviewUrl:null,isViewingLists:!1,listTitle:"",privateList:!1,lists:this.userLists,hasCollectedGame:!1}},created(){Object.keys(this.reviews).length===0&&(this.reviews[this.selectedPlatformId]={rating:null,review_headline:"",review_good:"",review_bad:"",review_bottomline:"",dirty:!1,new:!0}),Object.entries(this.reviews).forEach(([e])=>this.reviews[e].platform_id=parseInt(e,0)),Object.entries(this.reviews).forEach(([e])=>this.reviews[e].dirty=!1),this.originalReviews=JSON.parse(JSON.stringify(this.reviews)),Object.keys(this.userReviews).length>1&&(this.numReviews=Object.keys(this.userReviews).length),this.checkIfCollected(!0),this.lists.length>0&&this.lists.sort((e,t)=>{const d=this.descOrder?e.name.toUpperCase():t.name.toUpperCase(),u=this.descOrder?t.name.toUpperCase():e.name.toUpperCase();return d>u?-1:d<u?1:0}),window.addEventListener("click",e=>{this.$el.contains(e.target)||(this.isViewingLists=!1,this.isReviewing&&(this.selectedReview.review_headline||this.selectedReview.review_good||this.selectedReview.review_bad||this.selectedReview.review_bottomline||this.cancelReview()))})},watch:{selectedReview:{handler(e,t){this.isReviewing&&e.platform_id===t.platform_id&&(this.selectedReview.dirty=!0)},deep:!0}},computed:{userScoreLabel(){return this.isReviewing&&(!this.hasReview||this.selectedReview.dirty)?"Reviewing":this.hasReview?"Your Score":"Review"},reviewButtonLabel(){return this.selectedReview.review_headline||this.selectedReview.review_good||this.selectedReview.review_bad||this.selectedReview.review_bottomline?"Review":"Rating Alone"},starsStyleUser(){return`--rating: ${this.displayedScore}`},userScoreTitle(){return this.hoverScore>0?`Award ${this.hoverScore} stars`:this.displayedScore>0&&this.numReviews>1&&!this.isReviewing?`You rated this an average of ${this.displayedScore} stars`:this.displayedScore>0?`You rated this ${this.displayedScore} stars`:"You haven't rated this yet"},selectedReview(){return this.reviews[this.selectedReviewPlatformId]},hasReview(){return!!(this.selectedReview.rating||this.selectedReview.review_headline||this.selectedReview.review_good||this.selectedReview.review_bad||this.selectedReview.review_bottomline)}},methods:{toggleLists(){if(this.isReviewing&&(this.isReviewing=!1),!this.authenticated){this.showModal(`Please <a href="${this.loginUrl}">log in</a> to collect games.`);return}this.isViewingLists=!this.isViewingLists},checkIfCollected(e=!1){let t=!1;this.lists.some(d=>(t=d.games.find(({game_id:u})=>u===this.gameId),!!t)),t?(this.hasCollectedGame=!0,e&&!t.platforms.includes(this.selectedPlatformId)&&(this.selectedPlatformId=t.platforms[0])):this.hasCollectedGame=!1},getGameInList(e){return e.games.find(({game_id:t})=>t===this.gameId)},hasGameAndPlatformInList(e){const t=this.getGameInList(e);return!!(t&&t.platforms.includes(this.selectedPlatformId))},async toggleGameInList(e){if(!this.authenticated){this.showModal(`Please <a href="${this.loginUrl}">log in</a> to use this.`);return}let t="add";if(this.hasGameAndPlatformInList(e)){const a=this.getGameInList(e),m={};if(Array.from(a.platforms).forEach(n=>{m[n]=(m[n]||0)+1}),m[this.selectedPlatformId]>1){this.showModal(`You have multiple copies of this game in your list. You can select which one to remove via the <a href="${e.internal_url}">list view</a>.`),this.isLoading=!1;return}t="remove"}const{onSubmit:d}=U(this.$props),u={list_id:e.id,platform_id:this.selectedPlatformId,action:t,game_id:this.gameId};if(await d(this.listActionUrl,u)){if(t==="remove"){const a=this.getGameInList(e);a.platforms=a.platforms.filter(m=>m!==this.selectedPlatformId),a.platforms.length===0&&(e.games=e.games.filter(m=>m.game_id!==this.gameId))}else{const a=this.getGameInList(e);a?a.platforms.push(this.selectedPlatformId):e.games.push({game_id:this.gameId,platforms:[this.selectedPlatformId]})}this.isLoading=!1,this.checkIfCollected()}},async addList(){const{result:e,onSubmit:t}=U(this.$props),d={_csrf_token:this.csrfToken,name:this.listTitle,description:"",private:this.privateList,purchase_private:!1};await t(this.listAddUrl,d)?(this.listTitle="",this.lists.push(e.data.list),this.$refs.addListToggle.removeAttribute("open")):console.error(e.errors)},onStarHover(e){(this.displayedScore===0||this.isReviewing)&&(this.hoverScore=e)},showReview(e){if(this.isViewingLists&&(this.isViewingLists=!1),!this.authenticated){this.showModal(`Please <a href="${this.loginUrl}">log in</a> to review games.`);return}(e&&this.displayedScore===0||this.isReviewing)&&(this.selectedReview.rating=e,this.displayedScore=e),this.isReviewing=!0},reset(){this.reviews=JSON.parse(JSON.stringify(this.originalReviews)),this.displayedScore=this.userScore,this.isReviewing=!1},cancelReview(){this.reset()},deleteReview(){this.showModal("Sorry, this isn't implemented yet. Please check back with the next release.")},async submitReview(){const{result:e,onSubmit:t}=U(this.$props),d={_update_review_text:!0,value:this.selectedReview.rating,anonymous:!1,hidden:!1,user_id:this.userId,game_id:this.gameId,platform_id:this.selectedReview.platform_id,review_good:this.selectedReview.review_good,review_bad:this.selectedReview.review_bad,review_bottomline:this.selectedReview.review_bottomline,review_headline:this.selectedReview.review_headline};if(await t(this.actionUrl,d))this.reviewed=!0,this.isReviewing=!1,this.reviewUrl=e.data.url;else{let r='<ul class="list-group">';Object.values(e.errors).forEach(a=>{r=r.concat("<li>",a,"</li>")}),this.showModal(r.concat("</ul>"))}},showModal(e){this.modal=!0,this.modalBodyText=e}}},vn={class:"position-relative h100 hide-sm"},yn={class:"flex h100"},wn=["data-tooltip"],bn=s("br",null,null,-1),kn={key:0,class:"no-select"},Pn={key:1},Sn={key:2,class:"no-select"},Dn=s("b",{class:"text-success"},"Collected",-1),Cn=s("br",null,null,-1),Un={key:0,class:"icon icon-game",style:{display:"inline-block",width:"16px",height:"18px"},alt:"Missing game cover"},xn=["src"],Rn=s("b",null,"Add To",-1),Ln=s("br",null,null,-1),Vn={key:0,class:"bg-highlight form-review"},In={style:{display:"flex","align-items":"baseline"}},Tn=s("p",null," Add this game to your collection: ",-1),En={key:1,class:"list-group"},On={class:"flex flex-space-between p-1"},$n={class:"text-ellipsis"},An=["onClick"],Nn={key:0,class:"text-success"},Bn={class:"text-muted text-nowrap"},Mn=["href"],qn={key:2,class:"mb-sm"},Hn={ref:"addListToggle",class:"text-left"},Gn=s("summary",{class:"no-select text-sm"},"Add New List",-1),jn={class:"form-group text-left mt-sm mb-sm"},Fn={class:"form-group text-left mb-0"},Jn={class:"form-checkbox text-sm me-sm"},Yn=s("button",{class:"btn btn-xs btn-primary"},"Add New List",-1),Kn={key:1,class:"bg-highlight form-review"},zn={style:{display:"flex","align-items":"baseline"}},Zn={key:1},Qn={class:"form-group mb-sm"},Wn=s("small",{class:"text-muted"},"Headline / Summary",-1),Xn=s("br",null,null,-1),ea={class:"form-group mb-sm"},ta=s("small",{class:"text-muted"},"The Good",-1),sa=s("br",null,null,-1),ra={class:"form-group mb-sm"},oa=s("small",{class:"text-muted"},"The Bad",-1),ia=s("br",null,null,-1),na={class:"form-group mb-sm"},aa=s("small",{class:"text-muted"},"The Bottom Line",-1),la=s("br",null,null,-1),da={class:"flex"},ua={key:2,class:"form-review text-center"},ma=s("h4",null,"Thanks!",-1),ca={class:"text-bold"},ha=["href"],fa={class:"flex"},pa=["href"],ga=s("h4",{class:"text-danger"},"Error",-1),_a=["innerHTML"];function va(e,t,d,u,r,a){const m=T("v-select"),o=T("modal");return i(),l("div",vn,[s("div",yn,[s("div",{class:_(["width-max-content flex-center me border border-xxs border-bottom-none",{"bg-highlight":r.isReviewing}]),"data-tooltip":a.userScoreTitle},[s("div",null,[s("b",null,h(a.userScoreLabel),1),bn,r.numReviews>0&&!r.isReviewing?(i(),l("div",kn,[s("a",{href:"#",onClick:t[0]||(t[0]=v(n=>a.showReview(),["prevent"]))},h(r.displayedScore)+"/5 Average",1)])):r.displayedScore>0&&!r.isReviewing?(i(),l("div",Pn,[s("a",{href:"#",class:"stars stars-sm",style:M(a.starsStyleUser),onClick:t[1]||(t[1]=v(n=>a.showReview(),["stop","prevent"]))},null,4)])):(i(),l("div",Sn,[s("a",{href:"#",onMouseover:t[2]||(t[2]=n=>a.onStarHover(5)),onMouseleave:t[3]||(t[3]=n=>a.onStarHover(0)),onClick:t[4]||(t[4]=v(n=>a.showReview(5),["prevent"])),class:_(["score",{"score-selected":a.selectedReview.rating==5&&r.hoverScore==0}])},"\u2605",34),s("a",{href:"#",onMouseover:t[5]||(t[5]=n=>a.onStarHover(4)),onMouseleave:t[6]||(t[6]=n=>a.onStarHover(0)),onClick:t[7]||(t[7]=v(n=>a.showReview(4),["prevent"])),class:_(["score",{"score-selected":a.selectedReview.rating>=4&&r.hoverScore==0}])},"\u2605",34),s("a",{href:"#",onMouseover:t[8]||(t[8]=n=>a.onStarHover(3)),onMouseleave:t[9]||(t[9]=n=>a.onStarHover(0)),onClick:t[10]||(t[10]=v(n=>a.showReview(3),["prevent"])),class:_(["score",{"score-selected":a.selectedReview.rating>=3&&r.hoverScore==0}])},"\u2605",34),s("a",{href:"#",onMouseover:t[11]||(t[11]=n=>a.onStarHover(2)),onMouseleave:t[12]||(t[12]=n=>a.onStarHover(0)),onClick:t[13]||(t[13]=v(n=>a.showReview(2),["prevent"])),class:_(["score",{"score-selected":a.selectedReview.rating>=2&&r.hoverScore==0}])},"\u2605",34),s("a",{href:"#",onMouseover:t[14]||(t[14]=n=>a.onStarHover(1)),onMouseleave:t[15]||(t[15]=n=>a.onStarHover(0)),onClick:t[16]||(t[16]=v(n=>a.showReview(1),["prevent"])),class:_(["score",{"score-selected":a.selectedReview.rating>=1&&r.hoverScore==0}])},"\u2605",34)]))])],10,wn),s("div",{class:_(["flex-center border border-xxs border-bottom-none",{"bg-highlight":r.isViewingLists}])},[s("div",null,[r.hasCollectedGame?(i(),l(b,{key:0},[Dn,Cn,d.coverUrl==="None"?(i(),l("span",Un)):(i(),l("img",{key:1,src:d.coverUrl,class:"img-thumbnail-box img-thumbnail-xs",alt:"Game cover"},null,8,xn)),p(),s("a",{href:"#",onClick:t[17]||(t[17]=v((...n)=>a.toggleLists&&a.toggleLists(...n),["prevent"]))},"Edit")],64)):(i(),l(b,{key:1},[Rn,Ln,s("a",{href:"#",onClick:t[18]||(t[18]=v((...n)=>a.toggleLists&&a.toggleLists(...n),["prevent"]))},"Collection")],64))])],2)]),r.isViewingLists?(i(),l("div",Vn,[d.platforms.length>1?(i(),k(m,{key:0,name:"platform",class:"mb-sm",modelValue:r.selectedPlatformId,"onUpdate:modelValue":t[19]||(t[19]=n=>r.selectedPlatformId=n),placeholder:"Platform",label:"name",reduce:n=>n.id,options:d.platforms},{option:I(({name:n,release_date:V})=>[p(h(n)+" ("+h(V.split("-")[0])+") ",1)]),"selected-option":I(({name:n,release_date:V})=>[s("div",In,h(n)+" ("+h(V.split("-")[0])+") ",1)]),_:1},8,["modelValue","reduce","options"])):c("",!0),Tn,r.lists.length>0?(i(),l("ul",En,[(i(!0),l(b,null,N(r.lists,n=>(i(),l("li",On,[s("span",$n,[s("a",{href:"#",onClick:v(V=>a.toggleGameInList(n),["prevent"])},[a.hasGameAndPlatformInList(n)?(i(),l("span",Nn,"\u2713")):c("",!0),p(" "+h(n.name),1)],8,An),p(" ("+h(n.games.length)+") ",1),n.private?(i(),l(b,{key:0},[p(" (private) ")],64)):(i(),l(b,{key:1},[p(" (public) ")],64))]),s("span",Bn,[p(" [ "),s("a",{href:n.internal_url},"view list",8,Mn),p(" ] ")])]))),256))])):c("",!0),r.lists.length>0?(i(),l("hr",qn)):c("",!0),s("details",Hn,[Gn,s("form",{onSubmit:t[22]||(t[22]=v((...n)=>a.addList&&a.addList(...n),["prevent"]))},[s("div",jn,[g(s("input",{"onUpdate:modelValue":t[20]||(t[20]=n=>r.listTitle=n),class:"form-input form-input-sm text-sm",placeholder:"Title",maxlength:"40",required:""},null,512),[[w,r.listTitle]])]),s("div",Fn,[s("label",Jn,[g(s("input",{name:"private",type:"checkbox","onUpdate:modelValue":t[21]||(t[21]=n=>r.privateList=n)},null,512),[[B,r.privateList]]),p(" Private ")]),Yn])],32)],512)])):c("",!0),r.isReviewing?(i(),l("div",Kn,[d.platforms.length>1?(i(),k(m,{key:0,name:"platform",class:"mb-sm",modelValue:r.selectedReviewPlatformId,"onUpdate:modelValue":t[23]||(t[23]=n=>r.selectedReviewPlatformId=n),placeholder:"Platform",label:"name",reduce:n=>n.id,options:d.platforms},{option:I(({name:n,release_date:V})=>[p(h(n)+" ("+h(V.split("-")[0])+") ",1)]),"selected-option":I(({name:n,release_date:V})=>[s("div",zn,h(n)+" ("+h(V.split("-")[0])+") ",1)]),_:1},8,["modelValue","reduce","options"])):c("",!0),a.selectedReview.new?(i(),l("p",Zn,[p(" You can "),s("a",{href:"#",onClick:t[24]||(t[24]=v((...n)=>a.submitReview&&a.submitReview(...n),["prevent"]))},"submit your rating ("+h(a.selectedReview.rating)+"/5) by itself",1),p(", or even better, add your review: ")])):c("",!0),s("div",Qn,[Wn,Xn,g(s("input",{type:"text","onUpdate:modelValue":t[25]||(t[25]=n=>a.selectedReview.review_headline=n),name:"review_headline",class:"form-input",maxlength:"80"},null,512),[[w,a.selectedReview.review_headline]])]),s("div",ea,[ta,sa,g(s("textarea",{"onUpdate:modelValue":t[26]||(t[26]=n=>a.selectedReview.review_good=n),class:"form-input",rows:"3"},null,512),[[w,a.selectedReview.review_good]])]),s("div",ra,[oa,ia,g(s("textarea",{"onUpdate:modelValue":t[27]||(t[27]=n=>a.selectedReview.review_bad=n),class:"form-input",rows:"3"},null,512),[[w,a.selectedReview.review_bad]])]),s("div",na,[aa,la,g(s("textarea",{"onUpdate:modelValue":t[28]||(t[28]=n=>a.selectedReview.review_bottomline=n),class:"form-input",rows:"3"},null,512),[[w,a.selectedReview.review_bottomline]])]),s("div",da,[s("button",{class:"btn btn-sm btn-block me-sm",onClick:t[29]||(t[29]=(...n)=>a.cancelReview&&a.cancelReview(...n))},"Cancel"),a.selectedReview.new?(i(),l("button",{key:0,class:"btn btn-sm btn-primary btn-block",onClick:t[30]||(t[30]=(...n)=>a.submitReview&&a.submitReview(...n))},"Submit "+h(a.reviewButtonLabel),1)):c("",!0),a.hasReview&&a.selectedReview.dirty&&!a.selectedReview.new?(i(),l("button",{key:1,class:"btn btn-sm btn-warning btn-block",onClick:t[31]||(t[31]=(...n)=>a.submitReview&&a.submitReview(...n))},"Edit Review")):c("",!0),a.hasReview&&!a.selectedReview.dirty?(i(),l("button",{key:2,class:"btn btn-sm btn-danger btn-block",onClick:t[32]||(t[32]=(...n)=>a.deleteReview&&a.deleteReview(...n))},"Delete Review")):c("",!0)])])):c("",!0),r.reviewed?(i(),l("div",ua,[ma,s("p",ca,[a.selectedReview.review?(i(),l(b,{key:0},[s("a",{href:r.reviewUrl},"Your review",8,ha),p(" has been posted. ")],64)):(i(),l(b,{key:1},[p(" You rating has been recorded. ")],64))]),s("div",fa,[s("button",{class:"btn btn-sm btn-block me-sm",onClick:t[33]||(t[33]=n=>r.reviewed=!r.reviewed)},"Close"),s("a",{href:r.reviewUrl,class:"btn btn-sm btn-primary btn-block"},"View",8,pa)])])):c("",!0),L(o,{show:r.modal,onClose:t[34]||(t[34]=n=>r.modal=!1)},{header:I(()=>[ga]),body:I(()=>[s("span",{innerHTML:r.modalBodyText},null,8,_a)]),_:1},8,["show"])])}const ya=O(_n,[["render",va]]),wa={__name:"Random",props:{uri:{type:String,required:!0}},setup(e){const t=e,d=u=>{switch(u){case"ArrowLeft":window.history.go(-1);break;case"ArrowRight":window.location.href=`/random/${t.uri}/`;break}};return he(()=>{window.addEventListener("keyup",u=>{d(u.code)})}),(u,r)=>(i(),l("div"))}},ba={key:0},ka={class:"flex flex-align-center border border-1 mb"},Pa=s("p",{class:"mb-0"}," Did you find this review helpful? ",-1),Sa=s("span",{class:"icon icon-thumb-up"},null,-1),Da=s("span",{class:"icon icon-thumb-down"},null,-1),Ca={key:0,class:"loading text-normal"},Ua={__name:"RateReview",props:{csrfToken:String,actionUrl:String,reviewId:Number,initialValues:{type:Object,required:!0}},setup(e){const t=e,{formData:d,result:u,onSubmit:r}=U(t),a=async m=>{if(u.loading)return;let o=m!==0;d.score===m&&(o=-1);const n={helpful:o,review_id:t.reviewId};await r(t.actionUrl,n)&&(u.data.result==="deleted"?(d.num_votes-=1,d.score===1&&(d.num_helpful-=1),d.score=-1):(d.score===-1?(d.num_votes+=1,m===1&&(d.num_helpful+=1)):(d.score===0&&m===1&&(d.num_helpful+=1),d.score===1&&m===0&&(d.num_helpful-=1)),d.score=m))};return(m,o)=>(i(),l(b,null,[D(d).num_votes>0?(i(),l("p",ba,h(D(d).num_helpful)+" of "+h(D(d).num_votes)+" Moby users found this review helpful. ",1)):c("",!0),s("div",ka,[Pa,s("button",{onClick:o[0]||(o[0]=n=>a(1)),class:_(["btn btn-thumb flex-center",{"btn-thumb-selected":D(d).score==1,"text-success":D(d).score==1,"btn-thumb-fade":D(d).score==0}])},[Sa,p(" Yes ")],2),s("button",{onClick:o[1]||(o[1]=n=>a(0)),class:_(["btn btn-thumb flex-center",{"btn-thumb-selected":D(d).score==0,"text-danger":D(d).score==0,"btn-thumb-fade":D(d).score==1}])},[Da,p(" No ")],2),D(u).loading?(i(),l("span",Ca,"Loading")):c("",!0)])],64))}},xa={props:{actionUrl:{type:String,required:!0},csrfToken:{type:String,required:!0},privacyUrl:{type:String,required:!0},termsUrl:{type:String,required:!0},initialValues:{type:Object,required:!0}},setup:U},Ra=s("h1",null,"Register",-1),La={class:"form-group"},Va=s("span",{class:"floating-label"},"Display Name",-1),Ia={class:"form-group"},Ta=s("span",{class:"floating-label"},"Username",-1),Ea={class:"form-group"},Oa=s("span",{class:"floating-label"},"Email",-1),$a={class:"form-group"},Aa=s("span",{class:"floating-label"},"Password",-1),Na={class:"form-group"},Ba=["checked"],Ma={class:"form-group"},qa=["href"],Ha=["href"],Ga=["disabled"];function ja(e,t,d,u,r,a){const m=T("form-alert"),o=T("error");return i(),l("form",{onSubmit:t[6]||(t[6]=v(n=>e.onSubmit(d.actionUrl,e.formData),["prevent"])),onChange:t[7]||(t[7]=(...n)=>e.onChange&&e.onChange(...n)),onInvalidCapture:t[8]||(t[8]=v((...n)=>e.onInvalid&&e.onInvalid(...n),["prevent"])),class:"mb"},[Ra,s("div",La,[g(s("input",{type:"type",class:_(["form-input floating",{"border-danger":e.result.errors.display_name}]),name:"display_name","onUpdate:modelValue":t[0]||(t[0]=n=>e.formData.display_name=n),placeholder:" ",minlength:"3",maxlength:"50",required:""},null,2),[[w,e.formData.display_name]]),Va,e.result.errors.display_name?(i(),k(m,{key:0,msg:e.result.errors.display_name},null,8,["msg"])):c("",!0)]),s("div",Ia,[g(s("input",{type:"type",class:_(["form-input floating",{"border-danger":e.result.errors.user_name}]),name:"user_name","onUpdate:modelValue":t[1]||(t[1]=n=>e.formData.user_name=n),placeholder:" ",minlength:"3",maxlength:"20",required:""},null,2),[[w,e.formData.user_name]]),Ta,e.result.errors.user_name?(i(),k(m,{key:0,msg:e.result.errors.user_name},null,8,["msg"])):c("",!0)]),s("div",Ea,[g(s("input",{type:"email",class:_(["form-input floating",{"border-danger":e.result.errors.email}]),name:"email",autocomplete:"username","onUpdate:modelValue":t[2]||(t[2]=n=>e.formData.email=n),placeholder:" ",required:""},null,2),[[w,e.formData.email]]),Oa,e.result.errors.email?(i(),k(m,{key:0,msg:e.result.errors.email},null,8,["msg"])):c("",!0)]),s("div",$a,[g(s("input",{type:"password",class:_(["form-input floating",{"border-danger":e.result.errors.password}]),name:"password",autocomplete:"new-password","onUpdate:modelValue":t[3]||(t[3]=n=>e.formData.password=n),placeholder:" ",minlength:"6",maxlength:"255",required:""},null,2),[[w,e.formData.password]]),Aa,e.result.errors.password?(i(),k(m,{key:0,msg:e.result.errors.password},null,8,["msg"])):c("",!0)]),s("div",Na,[s("label",null,[g(s("input",{type:"checkbox",class:"form-check-input",name:"moby_mail_list","onUpdate:modelValue":t[4]||(t[4]=n=>e.formData.moby_mail_list=n),checked:e.formData.moby_mail_list},null,8,Ba),[[B,e.formData.moby_mail_list]]),p(" Subscribe to the MobyGames mailing list ")])]),s("div",Ma,[s("label",null,[g(s("input",{type:"checkbox",class:"form-check-input",name:"agree","onUpdate:modelValue":t[5]||(t[5]=n=>e.formData.agree=n),required:""},null,512),[[B,e.formData.agree]]),p(" I agree to the MobyGames "),s("a",{href:d.termsUrl,target:"_blank"},"Terms",8,qa),p(" & "),s("a",{href:d.privacyUrl,target:"_blank"},"Privacy Policy",8,Ha)]),e.result.errors.agree?(i(),k(m,{key:0,msg:e.result.errors.agree},null,8,["msg"])):c("",!0)]),L(o,{error:e.result.errors.SERVER_ERROR},null,8,["error"]),s("button",{type:"submit",class:"btn btn-primary",disabled:e.result.loading},"Register",8,Ga)],32)}const Fa=O(xa,[["render",ja]]),Ja={class:"overflow-x-scroll mb"},Ya={class:"table table-striped"},Ka={key:0},za={class:"text-center"},Za={class:"text-center"},Qa={class:"text-center"},Wa={key:0,class:"bg-highlight border-bottom"},Xa=s("b",null,"Overall",-1),el=s("br",null,null,-1),tl={key:0,class:"text-muted"},sl={class:"text-center text-sm"},rl=s("br",null,null,-1),ol=["href"],il=s("span",{class:"text-muted"},"n/a",-1),nl=s("br",null,null,-1),al={class:"text-center text-sm"},ll=["innerHTML"],dl=s("br",null,null,-1),ul=["href"],ml=s("span",{class:"text-muted"},"n/a",-1),cl=s("br",null,null,-1),hl={class:"text-center text-sm"},fl=s("br",null,null,-1),pl={class:"text-muted"},gl={class:"text-center text-sm"},_l=s("br",null,null,-1),vl=["href"],yl=s("span",{class:"text-muted"},"n/a",-1),wl=s("br",null,null,-1),bl={class:"text-center text-sm"},kl=["innerHTML"],Pl=s("br",null,null,-1),Sl=["href"],Dl=s("span",{class:"text-muted"},"n/a",-1),Cl=s("br",null,null,-1),Ul={class:"text-center text-sm"},xl={key:1},Rl={colspan:"4",class:"text-center"},Ll={__name:"Reviews",props:{reviews:Array,mobyrank:Object,mobyScore:Number,criticScore:Number,usersScore:Number,url:String},setup(e){const t=e,d=q(8),u={0:"#888",1:"#ff0000",2:"#ff0000",3:"#ff0000",4:"#ff0000",5:"#ff8000",6:"#ffff00",7:"#00ff00",8:"#31ffec",9:"#00bcff",10:"#ff00ff"},r=R=>`background: ${u[Math.floor(R)]};`,a=(R,x=!0,f=!1)=>`<span class="stars${x?" stars-sm":""}${f?" stars-10":""}" style="--rating: ${Math.round(R*10)/10}"></span>`,m=q("platform"),o=q(!1),n=R=>{o.value=!o.value,m.value=R},V=K(()=>t.reviews.sort((R,x)=>{if(m.value==="user_score"){if((R.user_total.rating||0)<(x.user_total.rating||0))return o.value?1:-1;if((R.user_total.rating||0)>(x.user_total.rating||0))return o.value?-1:1}else if(m.value==="platform"){if(R.platform.toUpperCase()<x.platform.toUpperCase())return o.value?1:-1;if(R.platform.toUpperCase()>x.platform.toUpperCase())return o.value?-1:1}else{if((R[m.value]||0)<(x[m.value]||0))return o.value?1:-1;if((R[m.value]||0)>(x[m.value]||0))return o.value?-1:1}return 0})),j=R=>t.mobyrank.platform_ranks.find(x=>x.id===R),A=K(()=>t.reviews.find(R=>R.platform_id===null));return(R,x)=>{const f=fe("tooltip");return i(),l("div",Ja,[s("table",Ya,[e.reviews.length>2?(i(),l("thead",Ka,[s("tr",null,[s("th",null,[s("a",{href:"#",onClick:x[0]||(x[0]=v(y=>n("platform"),["prevent"]))},"Platform"),m.value==="platform"?(i(),l("span",{key:0,class:_(["arrow ms-1",{"arrow-down":!o.value,"arrow-up":o.value}])},null,2)):c("",!0)]),s("th",za,[s("a",{href:"#",onClick:x[1]||(x[1]=v(y=>n("critic_score"),["prevent"]))},"Critics"),m.value==="critic_score"?(i(),l("span",{key:0,class:_(["arrow ms-1",{"arrow-down":o.value,"arrow-up":!o.value}])},null,2)):c("",!0)]),s("th",Za,[s("a",{href:"#",onClick:x[2]||(x[2]=v(y=>n("user_score"),["prevent"]))},"Players"),m.value==="user_score"?(i(),l("span",{key:0,class:_(["arrow ms-1",{"arrow-down":o.value,"arrow-up":!o.value}])},null,2)):c("",!0)]),s("th",Qa,[s("a",{href:"#",onClick:x[3]||(x[3]=v(y=>n("moby_score"),["prevent"]))},"Moby Score"),m.value==="moby_score"?(i(),l("span",{key:0,class:_(["arrow ms-1",{"arrow-down":o.value,"arrow-up":!o.value}])},null,2)):c("",!0)])])])):c("",!0),s("tbody",null,[e.reviews.length>2?(i(),l("tr",Wa,[s("td",null,[Xa,el,e.mobyrank.rank.rank?(i(),l("small",tl," Ranked #"+h(e.mobyrank.rank.rank.toLocaleString())+" of "+h(e.mobyrank.rank.total.toLocaleString())+" games ",1)):c("",!0)]),s("td",sl,[D(A).num_critic_reviews>0?(i(),l(b,{key:0},[p(h(D(A).critic_score)+"%",1),rl,s("a",{href:e.url},h(D(A).num_critic_reviews)+" ratings",9,ol)],64)):(i(),l(b,{key:1},[il,nl,p(" "+h(D(A).num_critic_reviews)+" ratings ",1)],64))]),s("td",al,[D(A).user_total.count>0?(i(),l(b,{key:0},[g(s("span",{innerHTML:a(D(A).user_total.rating)},null,8,ll),[[f,`${D(A).user_total.rating} stars`]]),dl,s("a",{href:e.url},h(D(A).user_total.count)+" ratings",9,ul)],64)):(i(),l(b,{key:1},[ml,cl,p(" "+h(D(A).user_total.count)+" ratings ",1)],64))]),s("td",hl,[D(A).moby_score!==null?g((i(),l("div",{key:0,class:"mobyscore mobyscore-lg",style:M(r(D(A).moby_score))},[p(h(D(A).moby_score),1)],4)),[[f,"Based on a bayesian average of critic and player ratings"]]):g((i(),l("div",{key:1,class:"mobyscore mobyscore-lg",style:M(r(0))},[p(" n/a ")],4)),[[f,"Not enough reviews available"]])])])):c("",!0),(i(!0),l(b,null,N(D(V).filter(y=>y.platform_id!==null).slice(0,d.value),y=>(i(),l("tr",{key:y},[s("td",null,[p(h(y.platform),1),fl,s("small",pl,[j(y.platform_id)?(i(),l(b,{key:0},[p(" Ranked #"+h(j(y.platform_id).rank.toLocaleString())+" of "+h(j(y.platform_id).total.toLocaleString())+" games ",1)],64)):(i(),l(b,{key:1},[p(" Unranked (needs more reviews) ")],64))])]),s("td",gl,[y.critic_score!=null?(i(),l(b,{key:0},[p(h(y.critic_score)+"%",1),_l,s("a",{href:y.reviews_url},h(y.num_critic_reviews)+" "+h(y.num_critic_reviews===1?"rating":"ratings"),9,vl)],64)):(i(),l(b,{key:1},[yl,wl,p(" "+h(y.num_critic_reviews)+" "+h(y.num_critic_reviews===1?"rating":"ratings"),1)],64))]),s("td",bl,[y.user_total.count>0?(i(),l(b,{key:0},[g(s("span",{innerHTML:a(y.user_total.rating)},null,8,kl),[[f,`${y.user_total.rating} stars`]]),Pl,s("a",{href:y.reviews_url},h(y.user_total.count)+" "+h(y.user_total.count===1?"rating":"ratings"),9,Sl)],64)):(i(),l(b,{key:1},[Dl,Cl,p(" "+h(y.user_total.count)+" "+h(y.user_total.count===1?"rating":"ratings"),1)],64))]),s("td",Ul,[y.moby_score!==null?g((i(),l("div",{key:0,class:"mobyscore mobyscore-lg",style:M(r(y.moby_score))},[p(h(y.moby_score),1)],4)),[[f,"Based on a bayesian average of critic and player ratings"]]):g((i(),l("div",{key:1,class:"mobyscore mobyscore-lg",style:M(r(0))},[p(" n/a ")],4)),[[f,"Not enough reviews available"]])])]))),128)),d.value<e.reviews.length?(i(),l("tr",xl,[s("td",Rl,[s("a",{href:"#",onClick:x[4]||(x[4]=v(y=>d.value=e.reviews.length,["prevent"]))}," Show all "+h(e.reviews.length)+" platforms ",1)])])):c("",!0)])])])}}},Vl={props:{actionUrl:{type:String,required:!0},csrfToken:{type:String,required:!0},initialValues:{type:Object,required:!0}},setup(e){const{formData:t,result:d,onSubmit:u,onChange:r,onInvalid:a}=U(e);return{onCustomSubmit:async()=>{const o={_csrf_token:e.csrfToken,title:t.title,body:t.body,enabled:t.enabled};u(e.actionUrl,o,t.delay)},onChange:r,onInvalid:a,formData:t,result:d}}},Il={class:"form-group"},Tl={class:"form-group"},El={class:"form-group"},Ol={class:"form-group"},$l={class:"form-group"},Al={class:"form-group"},Nl={class:"form-group"},Bl={class:"grid grid-split"},Ml={class:"form-group"},ql=s("label",null,"A date between September 5th and 10th",-1),Hl={class:"form-group"},Gl=s("label",null,"Any 2022 date",-1),jl={class:"form-group"},Fl=["checked"],Jl=["disabled"],Yl={key:0,class:"loading"},Kl={key:1,class:"text-bold text-success"};function zl(e,t,d,u,r,a){const m=T("form-alert"),o=T("error");return i(),l("form",{onSubmit:t[10]||(t[10]=v((...n)=>u.onCustomSubmit&&u.onCustomSubmit(...n),["prevent"])),onChange:t[11]||(t[11]=(...n)=>u.onChange&&u.onChange(...n)),onInvalidCapture:t[12]||(t[12]=v((...n)=>u.onInvalid&&u.onInvalid(...n),["prevent"]))},[s("div",Il,[g(s("input",{type:"text",class:_(["form-input",{"border-danger":u.result.errors.title}]),name:"title","onUpdate:modelValue":t[0]||(t[0]=n=>u.formData.title=n),placeholder:"Text Input (at least 1 character)",minlength:"1",maxlength:"50",required:""},null,2),[[w,u.formData.title]]),u.result.errors.title?(i(),k(m,{key:0,msg:u.result.errors.title},null,8,["msg"])):c("",!0)]),s("div",Tl,[g(s("textarea",{class:_(["form-input",{"border-danger":u.result.errors.body}]),rows:"5",name:"body","onUpdate:modelValue":t[1]||(t[1]=n=>u.formData.body=n),placeholder:"Textarea (at least 5 characters)",minlength:"5",maxlength:"10000",required:""},`
      `,2),[[w,u.formData.body]]),u.result.errors.body?(i(),k(m,{key:0,msg:u.result.errors.body},null,8,["msg"])):c("",!0)]),s("div",El,[g(s("input",{type:"number",class:_(["form-input",{"border-danger":u.result.errors.howmany}]),name:"howmany","onUpdate:modelValue":t[2]||(t[2]=n=>u.formData.howmany=n),placeholder:"Integer input (enter a number greater than 1)",step:"1",min:"1",required:""},null,2),[[w,u.formData.howmany]]),u.result.errors.howmany?(i(),k(m,{key:0,msg:u.result.errors.howmany},null,8,["msg"])):c("",!0)]),s("div",Ol,[g(s("input",{type:"number",class:_(["form-input",{"border-danger":u.result.errors.float}]),name:"float","onUpdate:modelValue":t[3]||(t[3]=n=>u.formData.float=n),placeholder:"Float input (0.01 to 10.0)",step:"0.01",min:"0.01",max:"10",required:""},null,2),[[w,u.formData.float]]),u.result.errors.float?(i(),k(m,{key:0,msg:u.result.errors.float},null,8,["msg"])):c("",!0)]),s("div",$l,[g(s("input",{type:"url",class:_(["form-input",{"border-danger":u.result.errors.url}]),name:"url","onUpdate:modelValue":t[4]||(t[4]=n=>u.formData.url=n),placeholder:"URL",required:""},null,2),[[w,u.formData.url]]),u.result.errors.url?(i(),k(m,{key:0,msg:u.result.errors.url},null,8,["msg"])):c("",!0)]),s("div",Al,[g(s("input",{type:"email",class:_(["form-input",{"border-danger":u.result.errors.email}]),name:"email",autocomplete:"username","onUpdate:modelValue":t[5]||(t[5]=n=>u.formData.email=n),placeholder:"Email address",required:""},null,2),[[w,u.formData.email]]),u.result.errors.email?(i(),k(m,{key:0,msg:u.result.errors.email},null,8,["msg"])):c("",!0)]),s("div",Nl,[g(s("input",{type:"password",class:_(["form-input",{"border-danger":u.result.errors.password}]),name:"password",autocomplete:"new-password","onUpdate:modelValue":t[6]||(t[6]=n=>u.formData.password=n),placeholder:"Password (min 8 characters)",minlength:"8",required:""},null,2),[[w,u.formData.password]]),u.result.errors.password?(i(),k(m,{key:0,msg:u.result.errors.password},null,8,["msg"])):c("",!0)]),s("div",Bl,[s("div",Ml,[ql,g(s("input",{type:"date",class:_(["form-input",{"border-danger":u.result.errors.date}]),name:"date","onUpdate:modelValue":t[7]||(t[7]=n=>u.formData.date=n),min:"2022-09-05",max:"2022-09-10",required:""},null,2),[[w,u.formData.date]]),u.result.errors.date?(i(),k(m,{key:0,msg:u.result.errors.date},null,8,["msg"])):c("",!0)]),s("div",Hl,[Gl,g(s("input",{type:"date",class:_(["form-input",{"border-danger":u.result.errors.date2022}]),name:"date2022","onUpdate:modelValue":t[8]||(t[8]=n=>u.formData.date2022=n),min:"2022-01-01",max:"2022-12-31",required:""},null,2),[[w,u.formData.date2022]]),u.result.errors.date2022?(i(),k(m,{key:0,msg:u.result.errors.date2022},null,8,["msg"])):c("",!0)])]),s("div",jl,[s("label",null,[g(s("input",{type:"checkbox",class:"form-check-input",name:"enabled","onUpdate:modelValue":t[9]||(t[9]=n=>u.formData.enabled=n),checked:u.formData.enabled,required:""},null,8,Fl),[[B,u.formData.enabled]]),p(" I agree ")]),u.result.errors.enabled?(i(),k(m,{key:0,msg:u.result.errors.enabled},null,8,["msg"])):c("",!0)]),L(o,{error:u.result.errors.SERVER_ERROR},null,8,["error"]),s("button",{type:"submit",class:"btn btn-primary me-sm",disabled:u.result.loading},"Submit",8,Jl),u.result.loading?(i(),l("span",Yl,"Loading")):u.result.data.success?(i(),l("span",Kl,"Success!")):c("",!0)],32)}const Zl=O(Vl,[["render",zl]]),Ql={props:{actionUrl:{type:String,required:!0},csrfToken:{type:String,required:!0},initialValues:{type:Object,required:!0}},setup(e){const{formData:t,result:d,onSubmit:u,onChange:r,onInvalid:a}=U(e);return{onCustomSubmit:async()=>{const o={title:t.title,orphan:t.orphan};await u(e.actionUrl,o,t.delay)},onChange:r,onInvalid:a,formData:t,result:d}}},Wl={class:"form-group"},Xl={class:"form-group"},ed={class:"form-group"},td=["disabled"],sd={key:0,class:"loading"},rd={key:1,class:"text-bold text-success"};function od(e,t,d,u,r,a){const m=T("form-alert"),o=T("error");return i(),l("form",{onSubmit:t[3]||(t[3]=v((...n)=>u.onCustomSubmit&&u.onCustomSubmit(...n),["prevent"])),onChange:t[4]||(t[4]=(...n)=>u.onChange&&u.onChange(...n)),onInvalidCapture:t[5]||(t[5]=v((...n)=>u.onInvalid&&u.onInvalid(...n),["prevent"]))},[s("div",Wl,[g(s("input",{type:"type",class:_(["form-input",{"border-danger":u.result.errors.title}]),name:"title","onUpdate:modelValue":t[0]||(t[0]=n=>u.formData.title=n),placeholder:"Text Input (at least 1 character)",minlength:"1",maxlength:"50",required:""},null,2),[[w,u.formData.title]]),u.result.errors.title?(i(),k(m,{key:0,msg:u.result.errors.title},null,8,["msg"])):c("",!0)]),s("div",Xl,[s("label",null,[g(s("input",{type:"checkbox",class:"form-check-input",name:"delay","onUpdate:modelValue":t[1]||(t[1]=n=>u.formData.delay=n)},null,512),[[B,u.formData.delay]]),p(" Add Loading Delay ")])]),s("div",ed,[s("label",null,[g(s("input",{type:"checkbox",class:"form-check-input",name:"orphan","onUpdate:modelValue":t[2]||(t[2]=n=>u.formData.orphan=n)},null,512),[[B,u.formData.orphan]]),p(" Test Orphan Error ")])]),L(o,{error:u.result.errors.SERVER_ERROR},null,8,["error"]),s("button",{type:"submit",class:"btn btn-primary me-sm",disabled:u.result.loading},"Submit",8,td),u.result.loading?(i(),l("span",sd,"Loading")):u.result.data.success?(i(),l("span",rd,"Success!")):c("",!0)],32)}const id=O(Ql,[["render",od]]),nd={props:{actionUrl:{type:String,required:!0},csrfToken:{type:String,required:!0},initialValues:{type:Object,required:!0}},setup:U},ad={class:"form-group"},ld=["disabled"],dd={key:0,class:"loading"},ud={key:1,class:"text-bold text-success"};function md(e,t,d,u,r,a){const m=T("form-alert"),o=T("error");return i(),l("form",{onSubmit:t[1]||(t[1]=v(n=>e.onSubmit(d.actionUrl,e.formData),["prevent"])),onChange:t[2]||(t[2]=(...n)=>e.onChange&&e.onChange(...n)),onInvalidCapture:t[3]||(t[3]=v((...n)=>e.onInvalid&&e.onInvalid(...n),["prevent"]))},[s("div",ad,[g(s("input",{type:"type",class:_(["form-input",{"border-danger":e.result.errors.title}]),name:"title","onUpdate:modelValue":t[0]||(t[0]=n=>e.formData.title=n),placeholder:"Text Input (at least 1 character)",minlength:"1",maxlength:"50",required:""},null,2),[[w,e.formData.title]]),e.result.errors.title?(i(),k(m,{key:0,msg:e.result.errors.title},null,8,["msg"])):c("",!0)]),L(o,{error:e.result.errors.SERVER_ERROR},null,8,["error"]),s("button",{type:"submit",class:"btn btn-primary me-sm",disabled:e.result.loading},"Submit",8,ld),e.result.loading?(i(),l("span",dd,"Loading")):e.result.data.success?(i(),l("span",ud,"Success!")):c("",!0)],32)}const cd=O(nd,[["render",md]]),hd={props:{elementId:{type:String},smallText:{type:Boolean,default:!1},singleLinePerItem:{type:Boolean,default:!1}},data(){return{show:!1,label:"Show More",isTruncated:!1,numLinesNotDisplayed:0,textEl:null}},mounted(){if(this.textEl=document.getElementById(this.elementId),!this.textEl)return;const e=window.getComputedStyle(this.textEl),t=parseInt(e.getPropertyValue("line-height"),10),d=Math.ceil(this.textEl.clientHeight/t);this.numLinesNotDisplayed=Math.ceil(this.textEl.scrollHeight/t)-d,this.numLinesNotDisplayed<2?this.textEl.style["-webkit-line-clamp"]=1e3:(this.show=!0,this.isTruncated=!0),this.setMoreLabel()},methods:{setMoreLabel(){this.singleLinePerItem?this.label=`${this.numLinesNotDisplayed} More`:this.label="More"},toggle(){this.isTruncated?(this.label="Less",this.textEl.classList.add("more"),this.isTruncated=!1):(this.setMoreLabel(),this.textEl.classList.remove("more"),this.isTruncated=!0)}}};function fd(e,t,d,u,r,a){return r.show?(i(),l("a",{key:0,href:"#!",onClick:t[0]||(t[0]=v((...m)=>a.toggle&&a.toggle(...m),["prevent"])),class:_(["text-muted text-nowrap",{"mt-sm":!d.smallText,"text-sm":d.smallText}])},[s("i",{class:_(["arrow",{"arrow-up":!r.isTruncated,"arrow-down":r.isTruncated,"arrow-sm":d.smallText}])},null,2),p(" "+h(r.label),1)],2)):c("",!0)}const pd=O(hd,[["render",fd]]),P=pe({setup(){const e=q(null),t=q(null),d=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);return P.directive("tooltip",{mounted(u,r){d||[["mouseenter",()=>e.value.show(u,r)],["mouseleave",()=>e.value.hide()]].forEach(([a,m])=>{u.addEventListener(a,m)})}}),P.directive("popover",{mounted(u,r){d||[["mouseenter",()=>t.value.show(u,r)],["mouseleave",()=>t.value.hide()]].forEach(([a,m])=>{u.addEventListener(a,m)})}}),{tooltip:e,popover:t}}});P.component("AdminProductCodes",Ae);P.component("App",ge);P.component("Alert",z);P.component("CompanyBrowser",it);P.component("CompanyBrowserList",ne);P.component("CoverSwapLinks",ht);P.component("DbStats",Lt);P.component("DeveloperBrowser",Zt);P.component("DeveloperBrowserList",ae);P.component("EditUserProfile",sr);P.component("Error",_e);P.component("FormAlert",ve);P.component("FormSelect",ye);P.component("GameBrowser",wo);P.component("GameList",we);P.component("ImageHotkeys",Uo);P.component("List",Ui);P.component("ListManager",gn);P.component("PlayerTools",ya);P.component("Modal",be);P.component("Popover",ke);P.component("Random",wa);P.component("RateReview",Ua);P.component("Register",Fa);P.component("Reviews",Ll);P.component("SandboxForm",Zl);P.component("SandboxFormCustom",id);P.component("SandboxFormSimple",cd);P.component("Search",Pe);P.component("Tooltip",Se);P.component("ToggleDarkMode",De);P.component("ToggleLongText",pd);P.component("vSelect",Ce);P.config.compilerOptions.whitespace="preserve";P.config.compilerOptions.isCustomElement=e=>e==="moby";P.mount("#root");xe(".lazyframe");const gd=window.location.pathname==="/";gd&&document.querySelectorAll("details").forEach(t=>{localStorage.getItem(t.id)==="open"?t.open=!0:localStorage.getItem(t.id)==="closed"&&(t.open=!1),t.addEventListener("toggle",()=>{if(!t.getAttribute("data-listener-added")){t.setAttribute("data-listener-added",!0);return}t.open?localStorage.setItem(t.id,"open"):localStorage.setItem(t.id,"closed")})});
